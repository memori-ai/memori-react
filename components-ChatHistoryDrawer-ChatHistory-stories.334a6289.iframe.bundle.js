/*! For license information please see components-ChatHistoryDrawer-ChatHistory-stories.334a6289.iframe.bundle.js.LICENSE.txt */
(self.webpackChunk_memori_ai_memori_react=self.webpackChunk_memori_ai_memori_react||[]).push([[2204],{"./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _arrayWithHoles(r){if(Array.isArray(r))return r}__webpack_require__.d(__webpack_exports__,{A:()=>_arrayWithHoles})},"./node_modules/@babel/runtime/helpers/esm/classCallCheck.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}__webpack_require__.d(__webpack_exports__,{A:()=>_classCallCheck})},"./node_modules/@babel/runtime/helpers/esm/createClass.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>_createClass});var _toPropertyKey_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js");function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(0,_toPropertyKey_js__WEBPACK_IMPORTED_MODULE_0__.A)(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}},"./node_modules/@babel/runtime/helpers/esm/defineProperty.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>_defineProperty});var _toPropertyKey_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js");function _defineProperty(e,r,t){return(r=(0,_toPropertyKey_js__WEBPACK_IMPORTED_MODULE_0__.A)(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}},"./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}__webpack_require__.d(__webpack_exports__,{A:()=>_nonIterableRest})},"./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>toPropertyKey});var esm_typeof=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/typeof.js");function toPropertyKey(t){var i=function toPrimitive(t,r){if("object"!=(0,esm_typeof.A)(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=(0,esm_typeof.A)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==(0,esm_typeof.A)(i)?i:i+""}},"./node_modules/@babel/runtime/helpers/esm/typeof.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}__webpack_require__.d(__webpack_exports__,{A:()=>_typeof})},"./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}__webpack_require__.d(__webpack_exports__,{A:()=>_unsupportedIterableToArray})},"./node_modules/lodash/_baseTrim.js":(module,__unused_webpack_exports,__webpack_require__)=>{var trimmedEndIndex=__webpack_require__("./node_modules/lodash/_trimmedEndIndex.js"),reTrimStart=/^\s+/;module.exports=function baseTrim(string){return string?string.slice(0,trimmedEndIndex(string)+1).replace(reTrimStart,""):string}},"./node_modules/lodash/_trimmedEndIndex.js":module=>{var reWhitespace=/\s/;module.exports=function trimmedEndIndex(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index}},"./node_modules/lodash/debounce.js":(module,__unused_webpack_exports,__webpack_require__)=>{var isObject=__webpack_require__("./node_modules/lodash/isObject.js"),now=__webpack_require__("./node_modules/lodash/now.js"),toNumber=__webpack_require__("./node_modules/lodash/toNumber.js"),nativeMax=Math.max,nativeMin=Math.min;module.exports=function debounce(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function remainingWait(time){var timeWaiting=wait-(time-lastCallTime);return maxing?nativeMin(timeWaiting,maxWait-(time-lastInvokeTime)):timeWaiting}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return function leadingEdge(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}(lastCallTime);if(maxing)return clearTimeout(timerId),timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function cancel(){void 0!==timerId&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=void 0},debounced.flush=function flush(){return void 0===timerId?result:trailingEdge(now())},debounced}},"./node_modules/lodash/now.js":(module,__unused_webpack_exports,__webpack_require__)=>{var root=__webpack_require__("./node_modules/lodash/_root.js");module.exports=function(){return root.Date.now()}},"./node_modules/lodash/toNumber.js":(module,__unused_webpack_exports,__webpack_require__)=>{var baseTrim=__webpack_require__("./node_modules/lodash/_baseTrim.js"),isObject=__webpack_require__("./node_modules/lodash/isObject.js"),isSymbol=__webpack_require__("./node_modules/lodash/isSymbol.js"),reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;module.exports=function toNumber(value){if("number"==typeof value)return value;if(isSymbol(value))return NaN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value}},"./node_modules/react-i18next/dist/es/context.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{gJ:()=>I18nContext,hz:()=>ReportNamespaces,rV:()=>getDefaults,TO:()=>getI18n});var classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),react=(__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),__webpack_require__("./node_modules/react/index.js")),matchHtmlEntity=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,htmlEntities={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},unescapeHtmlEntity=function unescapeHtmlEntity(m){return htmlEntities[m]};var i18nInstance,defaultOptions={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:function unescape(text){return text.replace(matchHtmlEntity,unescapeHtmlEntity)}},I18nContext=(0,react.createContext)();function getDefaults(){return defaultOptions}var ReportNamespaces=function(){function ReportNamespaces(){(0,classCallCheck.A)(this,ReportNamespaces),this.usedNamespaces={}}return(0,createClass.A)(ReportNamespaces,[{key:"addUsedNamespaces",value:function addUsedNamespaces(namespaces){var _this=this;namespaces.forEach((function(ns){_this.usedNamespaces[ns]||(_this.usedNamespaces[ns]=!0)}))}},{key:"getUsedNamespaces",value:function getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}]),ReportNamespaces}();function getI18n(){return i18nInstance}},"./node_modules/react/cjs/react-jsx-runtime.production.min.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var f=__webpack_require__("./node_modules/react/index.js"),k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function q(c,a,g){var b,d={},e=null,h=null;for(b in void 0!==g&&(e=""+g),void 0!==a.key&&(e=""+a.key),void 0!==a.ref&&(h=a.ref),a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l,exports.jsx=q,exports.jsxs=q},"./node_modules/react/jsx-runtime.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__("./node_modules/react/cjs/react-jsx-runtime.production.min.js")},"./src/components/ChatHistoryDrawer/ChatHistory.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,EmptyState:()=>EmptyState,LoadingState:()=>LoadingState,WithPagination:()=>WithPagination,WithSearch:()=>WithSearch,WithSelectedChat:()=>WithSelectedChat,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _ChatHistory__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/ChatHistoryDrawer/ChatHistory.tsx");const mockApiClient={chatLogs:{getChatLogsByUser:()=>Promise.resolve({chatLogs:mockChatLogs})}},mockChatLogs=[{chatLogID:"chat123456",memoriID:"mem123",sessionID:"session123",timestamp:"2023-01-01T10:00:00Z",lines:[{text:"Hello, how can I help?",inbound:!0,timestamp:"2023-01-01T10:00:00Z",contextVars:{},media:[],memoryID:"mem123"},{text:"I need information about your services",inbound:!1,timestamp:"2023-01-01T10:01:00Z",contextVars:{},media:[],memoryID:"mem123"},{text:"We offer a range of services including consultation, implementation, and support.",inbound:!0,timestamp:"2023-01-01T10:02:00Z",contextVars:{},media:[],memoryID:"mem123"}],boardOfExperts:!1},{chatLogID:"chat456789",memoriID:"mem123",sessionID:"session123",timestamp:"2023-01-02T14:00:00Z",lines:[{text:"What are your business hours?",inbound:!1,timestamp:"2023-01-02T14:00:00Z",contextVars:{},media:[],memoryID:"mem123"},{text:"We are open from 9 AM to 5 PM weekdays.",inbound:!0,timestamp:"2023-01-02T14:01:00Z",contextVars:{},media:[],memoryID:"mem123"}],boardOfExperts:!0},{chatLogID:"chat789012",memoriID:"mem123",sessionID:"session123",timestamp:"2023-01-03T11:00:00Z",lines:[{text:"Do you offer remote services?",inbound:!1,timestamp:"2023-01-03T11:00:00Z",contextVars:{},media:[],memoryID:"mem123"},{text:"Yes, we offer both in-person and remote services to accommodate your needs.",inbound:!0,timestamp:"2023-01-03T11:01:00Z",contextVars:{},media:[],memoryID:"mem123"}],boardOfExperts:!1},{chatLogID:"chat345678",memoriID:"mem123",sessionID:"session123",timestamp:"2023-01-04T09:30:00Z",lines:[{text:"What is your pricing structure?",inbound:!1,timestamp:"2023-01-04T09:30:00Z",contextVars:{},media:[],memoryID:"mem123"},{text:"Our pricing is based on project scope. We offer packages starting at $499 for basic services, with custom quotes for larger projects.",inbound:!0,timestamp:"2023-01-04T09:31:00Z",contextVars:{},media:[],memoryID:"mem123"},{text:"Do you offer any discounts?",inbound:!1,timestamp:"2023-01-04T09:32:00Z",contextVars:{},media:[],memoryID:"mem123"},{text:"Yes, we offer discounts for non-profits and educational institutions. We also have loyalty programs for returning customers.",inbound:!0,timestamp:"2023-01-04T09:33:00Z",contextVars:{},media:[],memoryID:"mem123"}],boardOfExperts:!1}],__WEBPACK_DEFAULT_EXPORT__={title:"Widget/Chat History Drawer",component:_ChatHistory__WEBPACK_IMPORTED_MODULE_0__.A,parameters:{layout:"fullscreen"},args:{open:!0,sessionId:"session123",memori:{memoriID:"mem123",name:"Test Memori",avatar:{url:"https://example.com/avatar.jpg"},description:"A test memori",isPublic:!0,integrationEnabled:!1,enableBoardOfExperts:!0,memoriConfigurationID:"mem123",privacyType:"PUBLIC",voiceType:"FEMALE"},apiClient:mockApiClient,onClose:()=>console.log("Close button clicked"),resumeSession:(sessionId,lines,questionsAndAnswers)=>{console.log("Resume session called with:",{sessionId,lines,questionsAndAnswers})}},argTypes:{open:{control:"boolean",description:"Whether the drawer is open"},layout:{control:{type:"select"},options:["DEFAULT","FLOATING","FULLPAGE","INLINE"],description:"Layout mode for the drawer"},onClose:{action:"closed"},resumeSession:{action:"resumed session"}}},Default={args:{}},WithSelectedChat={args:{},play:async({canvasElement})=>{const canvas=canvasElement.ownerDocument.body;setTimeout((()=>{const chatCard=canvas.querySelector(".memori-chat-history-drawer--card");chatCard&&chatCard.click()}),300)}},EmptyState={args:{apiClient:{chatLogs:{getChatLogsByUser:()=>Promise.resolve({chatLogs:[]})}}}},LoadingState={args:{apiClient:{chatLogs:{getChatLogsByUser:()=>new Promise((resolve=>{setTimeout((()=>{resolve({chatLogs:mockChatLogs})}),2e3)}))}}}},WithSearch={args:{},play:async({canvasElement})=>{const canvas=canvasElement.ownerDocument.body;setTimeout((()=>{const searchInput=canvas.querySelector('input[type="text"]');searchInput&&(searchInput.value="pricing",searchInput.dispatchEvent(new Event("change",{bubbles:!0})))}),300)}},WithPagination={args:{apiClient:{chatLogs:{getChatLogsByUser:()=>{const manyLogs=Array.from({length:20},((_,i)=>({chatLogID:`chat${i}`,lines:[{text:`Question ${i}`,inbound:!1,timestamp:`2023-01-0${i%9+1}T10:00:00Z`,contextVars:{},media:[],memoryID:"mem123",sessionID:"session123"},{text:`Answer ${i}`,inbound:!0,timestamp:`2023-01-0${i%9+1}T10:01:00Z`,contextVars:{},media:[],memoryID:"mem123",sessionID:"session123"}],boardOfExperts:i%3==0})));return Promise.resolve({chatLogs:manyLogs})}}}}};Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  args: {}\n}",...Default.parameters?.docs?.source}}},WithSelectedChat.parameters={...WithSelectedChat.parameters,docs:{...WithSelectedChat.parameters?.docs,source:{originalSource:"{\n  args: {},\n  play: async ({\n    canvasElement\n  }) => {\n    // We need to use the play function to simulate clicking on a chat\n    const canvas = canvasElement.ownerDocument.body;\n    setTimeout(() => {\n      const chatCard = canvas.querySelector('.memori-chat-history-drawer--card');\n      if (chatCard) {\n        (chatCard as HTMLElement).click();\n      }\n    }, 300);\n  }\n}",...WithSelectedChat.parameters?.docs?.source}}},EmptyState.parameters={...EmptyState.parameters,docs:{...EmptyState.parameters?.docs,source:{originalSource:"{\n  args: {\n    apiClient: {\n      chatLogs: {\n        getChatLogsByUser: () => Promise.resolve({\n          chatLogs: []\n        })\n      }\n    } as any\n  }\n}",...EmptyState.parameters?.docs?.source}}},LoadingState.parameters={...LoadingState.parameters,docs:{...LoadingState.parameters?.docs,source:{originalSource:"{\n  args: {\n    apiClient: {\n      chatLogs: {\n        getChatLogsByUser: () => new Promise(resolve => {\n          // Simulate a slow network\n          setTimeout(() => {\n            resolve({\n              chatLogs: mockChatLogs\n            });\n          }, 2000);\n        })\n      }\n    } as any\n  }\n}",...LoadingState.parameters?.docs?.source}}},WithSearch.parameters={...WithSearch.parameters,docs:{...WithSearch.parameters?.docs,source:{originalSource:"{\n  args: {},\n  play: async ({\n    canvasElement\n  }) => {\n    const canvas = canvasElement.ownerDocument.body;\n    setTimeout(() => {\n      const searchInput = canvas.querySelector('input[type=\"text\"]');\n      if (searchInput) {\n        (searchInput as HTMLInputElement).value = 'pricing';\n        (searchInput as HTMLInputElement).dispatchEvent(new Event('change', {\n          bubbles: true\n        }));\n      }\n    }, 300);\n  }\n}",...WithSearch.parameters?.docs?.source}}},WithPagination.parameters={...WithPagination.parameters,docs:{...WithPagination.parameters?.docs,source:{originalSource:"{\n  args: {\n    apiClient: {\n      chatLogs: {\n        getChatLogsByUser: () => {\n          // Create 20 mock chat logs to trigger pagination\n          const manyLogs = Array.from({\n            length: 20\n          }, (_, i) => ({\n            chatLogID: `chat${i}`,\n            lines: [{\n              text: `Question ${i}`,\n              inbound: false,\n              timestamp: `2023-01-0${i % 9 + 1}T10:00:00Z`,\n              contextVars: {},\n              media: [],\n              memoryID: 'mem123',\n              sessionID: 'session123'\n            }, {\n              text: `Answer ${i}`,\n              inbound: true,\n              timestamp: `2023-01-0${i % 9 + 1}T10:01:00Z`,\n              contextVars: {},\n              media: [],\n              memoryID: 'mem123',\n              sessionID: 'session123'\n            }],\n            boardOfExperts: i % 3 === 0\n          }));\n          return Promise.resolve({\n            chatLogs: manyLogs\n          });\n        }\n      }\n    } as any\n  }\n}",...WithPagination.parameters?.docs?.source}}};const __namedExportsOrder=["Default","WithSelectedChat","EmptyState","LoadingState","WithSearch","WithPagination"]},"./src/components/ChatHistoryDrawer/ChatHistory.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _ui_Drawer__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/ui/Drawer.tsx"),react_i18next__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_ui_Card__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/ui/Card.tsx"),_ui_Button__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/ui/Button.tsx"),_icons_Chat__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/icons/Chat.tsx"),_helpers_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/helpers/utils.ts"),_headlessui_react__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@headlessui/react/dist/components/dialog/dialog.js"),lodash_debounce__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/lodash/debounce.js"),lodash_debounce__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(lodash_debounce__WEBPACK_IMPORTED_MODULE_6__),_Chat_Chat__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/components/Chat/Chat.tsx"),_ui_Spin__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/components/ui/Spin.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react/jsx-runtime.js");const ChatHistoryDrawer=({open,onClose,apiClient,sessionId,memori,resumeSession,baseUrl,apiUrl})=>{const{t}=(0,react_i18next__WEBPACK_IMPORTED_MODULE_10__.B)(),{getChatLogsByUser,getSessionChatLogs}=apiClient.chatLogs,[chatLogs,setChatLogs]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),[selectedChatLog,setSelectedChatLog]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),[currentPage,setCurrentPage]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(1),[searchText,setSearchText]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(""),[isLoading,setIsLoading]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[error,setError]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),[sortOrder,setSortOrder]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)("desc"),fetchChatLogs=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((async()=>{setIsLoading(!0),setError(null);try{const res=await getChatLogsByUser(sessionId);setChatLogs(res.chatLogs.sort(((a,b)=>{const dateA=Math.max(...a.lines.map((l=>new Date(l.timestamp).getTime()))),dateB=Math.max(...b.lines.map((l=>new Date(l.timestamp).getTime())));return"desc"===sortOrder?dateB-dateA:dateA-dateB})))}catch(err){setError(t("errorFetchingSession")||"Error loading chat history"),console.error("Error fetching chat logs:",err)}finally{setIsLoading(!1)}}),[sessionId,sortOrder]);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{open&&fetchChatLogs()}),[open,fetchChatLogs]);const debouncedSearch=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((()=>lodash_debounce__WEBPACK_IMPORTED_MODULE_6___default()((value=>setSearchText(value)),300)),[]),filteredChatLogs=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((()=>chatLogs.filter((c=>c.lines.some((l=>l.text.toLowerCase().includes(searchText.toLowerCase())))&&c.lines.length>1))),[chatLogs,searchText]),totalPages=Math.ceil(filteredChatLogs.length/8),paginatedChatLogs=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((()=>{const startIndex=8*(currentPage-1);return filteredChatLogs.slice(startIndex,startIndex+8)}),[filteredChatLogs,currentPage]),handleResumeChat=async()=>{selectedChatLog&&(resumeSession(selectedChatLog),onClose())};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ui_Drawer__WEBPACK_IMPORTED_MODULE_0__.A,{className:"memori-chat-history-drawer",open,onClose,title:t("write_and_speak.chatHistory")||"Chat History",description:t("write_and_speak.chatHistoryDescription"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--content",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--toolbar",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--toolbar--search",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("input",{type:"search",className:"memori-chat-history-drawer--toolbar--search--input",placeholder:t("write_and_speak.searchInChatHistory")||"Search in chat history...",onChange:e=>debouncedSearch(e.target.value)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{className:"memori-chat-history-drawer--toolbar--search--icon",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-chat-history-drawer--toolbar--actions",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ui_Button__WEBPACK_IMPORTED_MODULE_3__.A,{onClick:()=>{setSortOrder((order=>"asc"===order?"desc":"asc")),setCurrentPage(1)},className:"memori-chat-history-drawer--toolbar--sort-button",children:t("desc"===sortOrder?"write_and_speak.latestFirst":"write_and_speak.oldestFirst")})})]}),isLoading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--loading",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ui_Spin__WEBPACK_IMPORTED_MODULE_8__.A,{spinning:!0,primary:!0,className:"memori-chat-history-drawer--loading--spinner"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("p",{className:"memori-chat-history-drawer--loading--text",children:t("write_and_speak.loadingChatHistory")||"Loading chat history..."})]}):error?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-chat-history-drawer--error",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("p",{children:error})}):chatLogs.length?0===filteredChatLogs.length?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-chat-history-drawer--no-results",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("p",{children:t("write_and_speak.noResultsFound",{searchText:searchText||""})||"No results found"})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("ul",{className:"memori-chat-history-drawer--list",children:paginatedChatLogs.map((chatLog=>{const lastMessageDate=Math.max(...chatLog.lines.map((line=>new Date(line.timestamp).getTime())));return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ui_Card__WEBPACK_IMPORTED_MODULE_2__.A,{hoverable:!0,onClick:async()=>{selectedChatLog?.chatLogID!==chatLog.chatLogID?setSelectedChatLog(chatLog):setSelectedChatLog(null)},className:"memori-chat-history-drawer--card "+(selectedChatLog?.chatLogID===chatLog.chatLogID?"memori-chat-history-drawer--card--selected":""),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-chat-history-drawer--card--header",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--card--header--content",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-chat-history-drawer--card--header--icon-wrapper",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_icons_Chat__WEBPACK_IMPORTED_MODULE_4__.default,{className:"memori-chat-history-drawer--card--header--icon"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--card--header--info",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--card--header--title-wrapper",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_headlessui_react__WEBPACK_IMPORTED_MODULE_11__.l.Title,{as:"h3",className:"memori-chat-history-drawer--card--header--title",children:"Chat-"+chatLog.chatLogID.substring(0,4)}),chatLog.boardOfExperts&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-chat-history-drawer--card--header--badge",children:"BOE"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--card--header--meta",children:[chatLog.lines.some((line=>line.media&&line.media.filter((m=>"text/html"!==m.mimeType&&"text/plain"!==m.mimeType)).length>0))&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("span",{className:"memori-chat-history-drawer--card--header--meta--messages",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("svg",{className:"memori-chat-history-drawer--card--header--meta--icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),chatLog.lines.reduce(((acc,line)=>acc+(line.media?.filter((m=>"text/html"!==m.mimeType&&"text/plain"!==m.mimeType)).length||0)),0)]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("span",{className:"memori-chat-history-drawer--card--header--meta--messages",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("svg",{className:"memori-chat-history-drawer--card--header--meta--icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),chatLog.lines.length]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("time",{className:"memori-chat-history-drawer--card--header--meta--time",dateTime:new Date(lastMessageDate).toISOString(),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("svg",{className:"memori-chat-history-drawer--card--header--meta--icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(timestamp=new Date(lastMessageDate).toISOString(),new Intl.DateTimeFormat(navigator.language,{dateStyle:"medium",timeStyle:"short"}).format(new Date(timestamp)))]})]})]})]})}),selectedChatLog?.chatLogID===chatLog.chatLogID&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--card--content",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-chat-history-drawer--card--content--messages",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Chat_Chat__WEBPACK_IMPORTED_MODULE_7__.A,{baseUrl,apiUrl,memoriTyping:!1,showTypingText:!1,showAIicon:!0,showTranslationOriginal:!1,showWhyThisAnswer:!1,showCopyButton:!1,showInputs:!1,history:chatLog.lines.map((line=>({text:(0,_helpers_utils__WEBPACK_IMPORTED_MODULE_5__.Sj)(line.text),contextVars:line.contextVars,media:line.media,fromUser:line.inbound,timestamp:line.timestamp}))),memori,sessionID:sessionId,setDialogState:()=>{},pushMessage:()=>{},simulateUserPrompt:()=>{},setSendOnEnter:()=>{},attachmentsMenuOpen:void 0,setAttachmentsMenuOpen:()=>{},userMessage:"",onChangeUserMessage:()=>{},sendMessage:()=>{},startListening:()=>{},stopListening:()=>{},resetTranscript:()=>{},listening:!1,setEnableFocusChatInput:()=>{},stopAudio:()=>{},isHistoryView:!0},`${chatLog.lines[0].text}-${chatLog.lines[0].timestamp}`)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-chat-history-drawer--card--content--actions",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ui_Button__WEBPACK_IMPORTED_MODULE_3__.A,{className:"memori-chat-history-drawer--card--content--resume-button",primary:!0,onClick:handleResumeChat,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--card--content--resume-button--content",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_icons_Chat__WEBPACK_IMPORTED_MODULE_4__.default,{className:"memori-chat-history-drawer--card--content--resume-button--icon"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{className:"memori-chat-history-drawer--card--content--resume-button--text",children:t("write_and_speak.resumeButton")||"Resume chat"})]})})})]})]})},chatLog.chatLogID);var timestamp}))}),totalPages>1&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--pagination",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ui_Button__WEBPACK_IMPORTED_MODULE_3__.A,{primary:!0,onClick:()=>setCurrentPage((p=>Math.max(1,p-1))),disabled:1===currentPage,className:"memori-chat-history-drawer--pagination--button",children:t("previous")||"Previous"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{className:"memori-chat-history-drawer--pagination--info",children:t("write_and_speak.page",{current:currentPage,total:totalPages})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ui_Button__WEBPACK_IMPORTED_MODULE_3__.A,{primary:!0,onClick:()=>setCurrentPage((p=>Math.min(totalPages,p+1))),disabled:currentPage===totalPages,className:"memori-chat-history-drawer--pagination--button",children:t("next")||"Next"})]})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-chat-history-drawer--empty",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_icons_Chat__WEBPACK_IMPORTED_MODULE_4__.default,{className:"memori-chat-history-drawer--empty--icon"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("p",{className:"memori-chat-history-drawer--empty--text",children:t("write_and_speak.noChatHistoryAvailable")||"No chat history available"})]})]})})};ChatHistoryDrawer.displayName="ChatHistoryDrawer";const __WEBPACK_DEFAULT_EXPORT__=ChatHistoryDrawer;try{ChatHistory.displayName="ChatHistory",ChatHistory.__docgenInfo={description:"",displayName:"ChatHistory",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},apiClient:{defaultValue:null,description:"",name:"apiClient",required:!0,type:{name:'{ constants: { BACKEND_URL: string; ENGINE_URL: string; allowedMediaTypes: string[]; anonTag: "👤"; }; asset: { getResourceUrl: ({ type, resourceURI, sessionID, baseURL, }: ResourceURLParams) => string; }; getAllFunctions: (sessionId: string) => Promise<...>; ... 134 more ...; backend: { ...; }; }'}},sessionId:{defaultValue:null,description:"",name:"sessionId",required:!0,type:{name:"string"}},memori:{defaultValue:null,description:"",name:"memori",required:!0,type:{name:"Memori"}},resumeSession:{defaultValue:null,description:"",name:"resumeSession",required:!0,type:{name:"(chatLog: ChatLog) => void"}},baseUrl:{defaultValue:null,description:"",name:"baseUrl",required:!0,type:{name:"string"}},apiUrl:{defaultValue:null,description:"",name:"apiUrl",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ChatHistoryDrawer/ChatHistory.tsx#ChatHistory"]={docgenInfo:ChatHistory.__docgenInfo,name:"ChatHistory",path:"src/components/ChatHistoryDrawer/ChatHistory.tsx#ChatHistory"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/icons/Chat.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const ChatRound=({className,title})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("svg",{...title?{}:{"aria-hidden":"true"},focusable:"false",width:"24",height:"24",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",className,"aria-label":title,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("path",{d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 13.5997 2.37562 15.1116 3.04346 16.4525C3.22094 16.8088 3.28001 17.2161 3.17712 17.6006L2.58151 19.8267C2.32295 20.793 3.20701 21.677 4.17335 21.4185L6.39939 20.8229C6.78393 20.72 7.19121 20.7791 7.54753 20.9565C8.88837 21.6244 10.4003 22 12 22Z",stroke:"currentColor","stroke-width":"1.5"})});ChatRound.displayName="ChatRound";const __WEBPACK_DEFAULT_EXPORT__=ChatRound;try{Chat.displayName="Chat",Chat.__docgenInfo={description:"",displayName:"Chat",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/icons/Chat.tsx#Chat"]={docgenInfo:Chat.__docgenInfo,name:"Chat",path:"src/components/icons/Chat.tsx#Chat"})}catch(__react_docgen_typescript_loader_error){}}}]);