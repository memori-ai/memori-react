"use strict";(self.webpackChunk_memori_ai_memori_react=self.webpackChunk_memori_ai_memori_react||[]).push([[2721],{"./src/components/ChatTextArea/ChatTextArea.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,WithLongText:()=>WithLongText,WithValue:()=>WithValue,__namedExportsOrder:()=>__namedExportsOrder,default:()=>ChatTextArea_stories});var react=__webpack_require__("./node_modules/react/index.js"),ChatTextArea=__webpack_require__("./src/components/ChatTextArea/ChatTextArea.tsx"),I18nWrapper=__webpack_require__("./src/I18nWrapper.tsx"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),ChatTextArea_ChatTextArea=__webpack_require__("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[7].use[1]!./src/components/ChatTextArea/ChatTextArea.css"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(ChatTextArea_ChatTextArea.A,options);ChatTextArea_ChatTextArea.A&&ChatTextArea_ChatTextArea.A.locals&&ChatTextArea_ChatTextArea.A.locals;var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const ChatTextArea_stories={title:"Widget/Chat textarea",component:ChatTextArea.A,argTypes:{disabled:{control:{type:"boolean"}}},parameters:{controls:{expanded:!0}}},Template=args=>{const[userMessage,setUserMessage]=react.useState(args.value);return(0,jsx_runtime.jsx)(I18nWrapper.A,{children:(0,jsx_runtime.jsx)("div",{style:{paddingTop:"10rem"},children:(0,jsx_runtime.jsx)(ChatTextArea.A,{...args,value:userMessage,onChange:setUserMessage})})})};Template.displayName="Template";const Default=Template.bind({});Default.args={value:"",onChange:()=>{}};const WithValue=Template.bind({});WithValue.args={value:"Suspendisse sit amet volutpat velit.",onChange:()=>{}};const WithLongText=Template.bind({});WithLongText.args={value:"Suspendisse sit amet volutpat velit. Nunc at commodo tortor, id rutrum nunc. Vivamus condimentum vel nunc et congue. Ut laoreet imperdiet nisi ac finibus. Suspendisse molestie risus a justo sagittis efficitur. Suspendisse sit amet volutpat velit. Nunc at commodo tortor, id rutrum nunc. Vivamus condimentum vel nunc et congue. Ut laoreet imperdiet nisi ac finibus. Suspendisse molestie risus a justo sagittis efficitur.",onChange:()=>{}},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => {\n  const [userMessage, setUserMessage] = React.useState(args.value);\n  return <I18nWrapper>\n      <div style={{\n      paddingTop: '10rem'\n    }}>\n        <ChatTextArea {...args} value={userMessage} onChange={setUserMessage} />\n      </div>\n    </I18nWrapper>;\n}",...Default.parameters?.docs?.source}}},WithValue.parameters={...WithValue.parameters,docs:{...WithValue.parameters?.docs,source:{originalSource:"args => {\n  const [userMessage, setUserMessage] = React.useState(args.value);\n  return <I18nWrapper>\n      <div style={{\n      paddingTop: '10rem'\n    }}>\n        <ChatTextArea {...args} value={userMessage} onChange={setUserMessage} />\n      </div>\n    </I18nWrapper>;\n}",...WithValue.parameters?.docs?.source}}},WithLongText.parameters={...WithLongText.parameters,docs:{...WithLongText.parameters?.docs,source:{originalSource:"args => {\n  const [userMessage, setUserMessage] = React.useState(args.value);\n  return <I18nWrapper>\n      <div style={{\n      paddingTop: '10rem'\n    }}>\n        <ChatTextArea {...args} value={userMessage} onChange={setUserMessage} />\n      </div>\n    </I18nWrapper>;\n}",...WithLongText.parameters?.docs?.source}}};const __namedExportsOrder=["Default","WithValue","WithLongText"]},"./src/components/ChatTextArea/ChatTextArea.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),react_i18next__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),_helpers_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/helpers/utils.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");const ChatTextArea=({disabled=!1,value,onChange,onPressEnter,onPaste,onFocus,onBlur,onExpandedChange})=>{const{t}=(0,react_i18next__WEBPACK_IMPORTED_MODULE_2__.B)(),textareaRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),innerRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{const textarea=textareaRef.current,inner=innerRef.current;if(textarea&&inner)if(0===value.length){textarea.style.height="36px",inner.style.height="36px",onExpandedChange&&onExpandedChange(!1);const chat=document.getElementsByClassName("memori-chat--content");if(chat){const lastChild=chat[chat.length-1];lastChild&&(lastChild.style.paddingBottom="0px")}}else{textarea.style.height="auto";const scrollHeight=textarea.scrollHeight,newHeight=Math.min(Math.max(scrollHeight,36),208);textarea.style.height=`${newHeight}px`,inner.style.height=`${newHeight}px`;const chat=document.getElementsByClassName("memori-chat--content");if(chat){chat[chat.length-1]&&chat[0].scrollTo({top:chat[0].scrollHeight,behavior:"smooth"})}}},[value]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{"data-testid":"chat-textarea",className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("memori-chat-textarea",{"memori-chat-textarea--disabled":disabled}),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{ref:innerRef,className:"memori-chat-textarea--inner",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("textarea",{ref:textareaRef,className:"memori-chat-textarea--input",disabled,value,placeholder:t("placeholder","Ask a question")||"Ask a question",onChange:e=>{onChange(e.target.value)},onKeyDownCapture:e=>{const isMobile=(0,_helpers_utils__WEBPACK_IMPORTED_MODULE_3__.Gz)();if("Enter"===e.key&&e.altKey&&!e.shiftKey&&!isMobile){e.preventDefault();const el=textareaRef.current,start=el?.selectionStart??value.length,end=el?.selectionEnd??value.length,nextValue=`${value.slice(0,start)}\n${value.slice(end)}`;return onChange(nextValue),void requestAnimationFrame(()=>{if(!el)return;const caret=start+1;el.selectionStart=caret,el.selectionEnd=caret})}"Enter"!==e.key||e.shiftKey||!onPressEnter||isMobile||onPressEnter(e)},onPaste,onFocus,onBlur,maxLength:1e5})})})};ChatTextArea.displayName="ChatTextArea";const __WEBPACK_DEFAULT_EXPORT__=ChatTextArea;try{ChatTextArea.displayName="ChatTextArea",ChatTextArea.__docgenInfo={description:"",displayName:"ChatTextArea",props:{disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}},onPressEnter:{defaultValue:null,description:"",name:"onPressEnter",required:!1,type:{name:"((e: KeyboardEvent<HTMLTextAreaElement>) => void)"}},onPaste:{defaultValue:null,description:"",name:"onPaste",required:!1,type:{name:"((e: ClipboardEvent<HTMLTextAreaElement>) => void)"}},onFocus:{defaultValue:null,description:"",name:"onFocus",required:!1,type:{name:"((e: FocusEvent<Element, Element>) => void)"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!1,type:{name:"((e: FocusEvent<Element, Element>) => void)"}},onExpandedChange:{defaultValue:null,description:"",name:"onExpandedChange",required:!1,type:{name:"((expanded: boolean) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ChatTextArea/ChatTextArea.tsx#ChatTextArea"]={docgenInfo:ChatTextArea.__docgenInfo,name:"ChatTextArea",path:"src/components/ChatTextArea/ChatTextArea.tsx#ChatTextArea"})}catch(__react_docgen_typescript_loader_error){}},"./src/helpers/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{DN:()=>correctMaterials,GZ:()=>isSkinnedMesh,Gz:()=>isMobileOrTablet,I2:()=>isSafariIOS,K1:()=>hasTouchscreen,Lr:()=>mailRegEx,N8:()=>safeParseJSON,TG:()=>cleanUrl,Vx:()=>stripDuplicates,Zn:()=>escapeHTML,_e:()=>stripHTML,eA:()=>stripMarkdown,f9:()=>stripOutputTags,gI:()=>stripReasoningTags,lA:()=>installMathJax,mo:()=>stripDocumentAttachmentTags,nr:()=>isSafari,o6:()=>stripEmojis,xD:()=>useDebounceFn});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),three__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/three/build/three.module.js");const hasTouchscreen=()=>{let hasTouchScreen=!1;if("undefined"==typeof window||"undefined"==typeof navigator)return hasTouchScreen;if("maxTouchPoints"in navigator)hasTouchScreen=navigator.maxTouchPoints>0;else if("msMaxTouchPoints"in navigator)hasTouchScreen=navigator.msMaxTouchPoints>0;else{const mQ=window&&"matchMedia"in window&&matchMedia("(pointer:coarse)");if(mQ&&"(pointer:coarse)"===mQ.media)hasTouchScreen=!!mQ.matches;else if("orientation"in window)hasTouchScreen=!0;else{var UA=navigator?.userAgent;hasTouchScreen=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(UA)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(UA)}}return hasTouchScreen},isMobileOrTablet=()=>{if("undefined"==typeof window||"undefined"==typeof navigator)return!1;if(!hasTouchscreen())return!1;const ua=navigator?.userAgent||"";return!!/\b(Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini)\b/i.test(ua)||window.innerWidth<=1024},isSafari=()=>{if("undefined"==typeof navigator)return!1;const userAgent=navigator.userAgent,isSafariUA=userAgent.includes("Safari")&&!userAgent.includes("Chrome"),isWebKit="WebKit"in window&&!("Chrome"in window);return isSafariUA||isWebKit},isSafariIOS=()=>{if("undefined"==typeof navigator)return!1;const userAgent=navigator.userAgent;return userAgent.includes("Safari")&&!userAgent.includes("Chrome")&&/iPad|iPhone|iPod/.test(userAgent)},mailRegEx=/^\w+([.-]?[+]?\w+)*@\w+([.-]?\w+)*(\.\w{2,})+$/;function useDebounceFn(fn,delay){const timeoutId=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),originalFn=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>(originalFn.current=fn,()=>{originalFn.current=null}),[fn]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>()=>{clearTimeout(timeoutId.current)},[]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>(...args)=>{clearTimeout(timeoutId.current),timeoutId.current=window.setTimeout(()=>{originalFn.current&&originalFn.current(...args)},delay)},[delay])}const stripDuplicates=text=>text.slice(0,text.length/2).trim().toLowerCase()===text.slice(text.length/2+1).trim().toLowerCase()?text.slice(0,text.length/2):text,stripEmojis=text=>text.replaceAll(/[^\p{L}\p{N}\p{P}\p{Z}^$\n]/gu,"").trim(),stripMarkdown=text=>text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=text.replaceAll(/```*?```/g,"")).replaceAll(/```[\s\S]*?```/g,"")).replaceAll(/`[^`]*`/g,"")).replaceAll(/!\[[^\]]*\]\([^)]*\)/g,"")).replaceAll(/\[([^\]]*)\]\([^)]*\)/g,"$1")).replaceAll(/^> /gm,"")).replaceAll(/^#+ /gm,"")).replaceAll(/[*_]/g,"")).replaceAll(/---/g,"")).replaceAll(/~~/g,"")).replaceAll(/^\s*[-*+] /gm,"")).replaceAll(/^\s*\d+\.\s+/gm,"")).replaceAll(/^\|.*\|$/gm,"")).replaceAll(/\$\$[\s\S]*?\$\$/g,"")).replaceAll(/\$[\s\S]*?\$/g,"")).replaceAll(/\\\([\s\S]*?\\\)/g,"")).replaceAll(/\\\[[\s\S]*?\\\]/g,"")).replaceAll(/\s+/g," ").trim(),stripDocumentAttachmentTags=text=>text.replace(/<document_attachment filename="([^"]+)" type="([^"]+)">([\s\S]*?)<\/document_attachment>/g,"$3"),stripOutputTags=text=>{const outputTagRegex=/<output.*?<\/output>/gs;if(!outputTagRegex.test(text))return text;const strippedText=text.replace(outputTagRegex,"");return stripOutputTags(strippedText)},stripReasoningTags=text=>{const reasoningTagRegex=/<think.*?<\/think>/gs;if(!reasoningTagRegex.test(text))return text;return text.replace(reasoningTagRegex,"")},stripHTML=text=>{const el=document.createElement("div");return el.innerHTML=text,el.textContent||""},escapeHTML=text=>{const el=document.createElement("textarea");return el.textContent=text,el.innerHTML};function cleanUrl(href){try{href=encodeURI(href).replace(/%25/g,"%")}catch(e){return null}return href}const mathJaxConfig={startup:{elements:[".memori-chat--bubble-content"]},options:{processHtmlClass:"memori-chat--bubble-content"},tex:{inlineMath:[["$","$"],["\\$","\\$"]],displayMath:[["$$","$$"]],processEscapes:!0},asciimath:{fixphi:!0,displaystyle:!0,decimalsign:"."},skipStartupTypeset:!0,chtml:{displayAlign:"left"},svg:{fontCache:"global"}},installMathJax=()=>{window.MathJax=mathJaxConfig,(()=>{const script=document.createElement("script");script.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js",script.async=!0,script.id="mathjax-script",document.head.appendChild(script)})()};function correctMaterials(materials){Object.values(materials).forEach(material=>{material instanceof three__WEBPACK_IMPORTED_MODULE_1__.MeshStandardMaterial&&(material.roughness=.8,material.metalness=.1,material.shadowSide=2,material.map&&(material.map.anisotropy=16))})}function isSkinnedMesh(object){return!0===object.isSkinnedMesh}const safeParseJSON=(jsonString,fallbackString=!1)=>{try{return JSON.parse(jsonString)}catch(error){return fallbackString?jsonString:null}}}}]);