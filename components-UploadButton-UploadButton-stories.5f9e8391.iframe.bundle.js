/*! For license information please see components-UploadButton-UploadButton-stories.5f9e8391.iframe.bundle.js.LICENSE.txt */
(self.webpackChunk_memori_ai_memori_react=self.webpackChunk_memori_ai_memori_react||[]).push([[3347],{"./src/components/UploadButton/UploadButton.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,Disabled:()=>Disabled,__namedExportsOrder:()=>__namedExportsOrder,default:()=>UploadButton_stories});var react=__webpack_require__("./node_modules/react/index.js"),I18nWrapper=__webpack_require__("./src/I18nWrapper.tsx"),UploadButton=__webpack_require__("./src/components/UploadButton/UploadButton.tsx"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),UploadButton_UploadButton=__webpack_require__("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[7].use[1]!./src/components/UploadButton/UploadButton.css"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(UploadButton_UploadButton.Z,options);UploadButton_UploadButton.Z&&UploadButton_UploadButton.Z.locals&&UploadButton_UploadButton.Z.locals;var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const UploadButton_stories={title:"Widget/Upload Button",component:UploadButton.Z,argTypes:{disabled:{control:{type:"boolean"}}},parameters:{controls:{expanded:!0}}},Template=args=>{const[previewFiles,setPreviewFiles]=(0,react.useState)([]);return(0,jsx_runtime.jsx)(I18nWrapper.Z,{children:(0,jsx_runtime.jsx)("div",{style:{minHeight:"200px",display:"flex",alignItems:"flex-end"},children:(0,jsx_runtime.jsx)(UploadButton.Z,{...args,setPreviewFiles})})})};Template.displayName="Template";const Default=Template.bind({});Default.args={onUpload:()=>{},convertapiToken:"c3lITDU8Pvr1ovTz"};const Disabled=Template.bind({});Disabled.args={onUpload:()=>{},convertapiToken:"c3lITDU8Pvr1ovTz",disabled:!0},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => {\n  const [previewFiles, setPreviewFiles] = useState<{\n    name: string;\n    id: string;\n    content: string;\n  }[]>([]);\n  return <I18nWrapper>\n      <div style={{\n      minHeight: '200px',\n      display: 'flex',\n      alignItems: 'flex-end'\n    }}>\n        <UploadButton {...args} setPreviewFiles={setPreviewFiles} />\n      </div>\n    </I18nWrapper>;\n}",...Default.parameters?.docs?.source}}},Disabled.parameters={...Disabled.parameters,docs:{...Disabled.parameters?.docs,source:{originalSource:"args => {\n  const [previewFiles, setPreviewFiles] = useState<{\n    name: string;\n    id: string;\n    content: string;\n  }[]>([]);\n  return <I18nWrapper>\n      <div style={{\n      minHeight: '200px',\n      display: 'flex',\n      alignItems: 'flex-end'\n    }}>\n        <UploadButton {...args} setPreviewFiles={setPreviewFiles} />\n      </div>\n    </I18nWrapper>;\n}",...Disabled.parameters?.docs?.source}}};const __namedExportsOrder=["Default","Disabled"]},"./src/components/UploadButton/UploadButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),convertapi_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/convertapi-js/dist/convertapi.js"),_icons_Upload__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/icons/Upload.tsx"),_ui_Spin__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/ui/Spin.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");const FileUploadButton=({setPreviewFiles})=>{const[isLoading,setIsLoading]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[error,setError]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),fileInputRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),[convertapiToken,setConvertapiToken]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)();(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{(async()=>{try{const result=await fetch("https://www.aisuru.com/api/convertapi-token"),response=await result.json();setConvertapiToken(response.Tokens?.[0]?.Id)}catch(error){console.error("Error fetching ConvertAPI token:",error)}})()}),[]);const convertToTxt=async file=>{if(!convertapiToken||!file)return console.error("Missing ConvertAPI token or file"),void setError("Missing ConvertAPI token or file");setIsLoading(!0);const fileExt=file.name.split(".").pop()||file.type.split("/").pop()||"pdf";try{const convertApi=convertapi_js__WEBPACK_IMPORTED_MODULE_5__.Z.auth(convertapiToken),params=convertApi.createParams();params.add("File",file),params.add("TextEncoding","UTF-8"),params.add("PageRange","1-2000");const fileUrl=(await convertApi.convert(fileExt,"txt",params)).files[0].Url,response=await fetch(fileUrl);return await response.text()}catch(error){console.error("Conversion error:",error),setError("Conversion error")}finally{setIsLoading(!1)}};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"file-upload-wrapper",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("input",{ref:fileInputRef,type:"file",accept:".pdf,.doc,.docx,.txt",className:"memori--upload-file-input",onChange:async e=>{const files=Array.from(e.target.files||[]),newPreviewFiles=[];for(const file of files){const fileId=Math.random().toString(36).substr(2,9),text=await convertToTxt(file);text?newPreviewFiles.push({name:file.name,id:fileId,content:text||""}):setError("Failed to convert file to text")}setPreviewFiles(newPreviewFiles)}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("button",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("memori-button","memori-button--circle","memori-button--icon-only","memori-share-button--button","memori--conversation-button",{"memori--error":error}),onClick:()=>fileInputRef.current?.click(),disabled:isLoading,children:isLoading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_ui_Spin__WEBPACK_IMPORTED_MODULE_3__.Z,{spinning:!0,className:"memori--upload-icon"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_icons_Upload__WEBPACK_IMPORTED_MODULE_2__.default,{className:"memori--upload-icon"})})]})};FileUploadButton.displayName="FileUploadButton";const __WEBPACK_DEFAULT_EXPORT__=FileUploadButton;try{UploadButton.displayName="UploadButton",UploadButton.__docgenInfo={description:"UploadButton component",displayName:"UploadButton",props:{setPreviewFiles:{defaultValue:null,description:"",name:"setPreviewFiles",required:!0,type:{name:"(previewFiles: { name: string; id: string; content: string; }[]) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/UploadButton/UploadButton.tsx#UploadButton"]={docgenInfo:UploadButton.__docgenInfo,name:"UploadButton",path:"src/components/UploadButton/UploadButton.tsx#UploadButton"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/icons/Loading.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Loading=({className,title,loading=!0})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("svg",{...title?{}:{"aria-hidden":"true"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",focusable:"false",role:"img",className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(className,{"memori-loading-icon":loading}),"aria-label":title,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("path",{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"})});Loading.displayName="Loading";const __WEBPACK_DEFAULT_EXPORT__=Loading;try{Loading.displayName="Loading",Loading.__docgenInfo={description:"",displayName:"Loading",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},loading:{defaultValue:{value:"true"},description:"",name:"loading",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/icons/Loading.tsx#Loading"]={docgenInfo:Loading.__docgenInfo,name:"Loading",path:"src/components/icons/Loading.tsx#Loading"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/icons/Upload.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");const UploadIcon=({className,title})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("svg",{...title?{}:{"aria-hidden":"true"},focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className,"aria-label":title,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"})});UploadIcon.displayName="UploadIcon";const __WEBPACK_DEFAULT_EXPORT__=UploadIcon;try{Upload.displayName="Upload",Upload.__docgenInfo={description:"",displayName:"Upload",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/icons/Upload.tsx#Upload"]={docgenInfo:Upload.__docgenInfo,name:"Upload",path:"src/components/icons/Upload.tsx#Upload"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/ui/Spin.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_icons_Loading__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/icons/Loading.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Spin=({spinning=!1,primary=!1,className,children})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("memori-spin",className,{"memori-spin--spinning":spinning,"memori-spin--primary":primary}),children:[children,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"memori-spin--spinner",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_icons_Loading__WEBPACK_IMPORTED_MODULE_2__.default,{loading:!0})})]});Spin.displayName="Spin";const __WEBPACK_DEFAULT_EXPORT__=Spin;try{Spin.displayName="Spin",Spin.__docgenInfo={description:"",displayName:"Spin",props:{spinning:{defaultValue:{value:"false"},description:"",name:"spinning",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},primary:{defaultValue:{value:"false"},description:"",name:"primary",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/Spin.tsx#Spin"]={docgenInfo:Spin.__docgenInfo,name:"Spin",path:"src/components/ui/Spin.tsx#Spin"})}catch(__react_docgen_typescript_loader_error){}},"./node_modules/classnames/index.js":(module,exports)=>{var __WEBPACK_AMD_DEFINE_RESULT__;!function(){"use strict";var hasOwn={}.hasOwnProperty;function classNames(){for(var classes="",i=0;i<arguments.length;i++){var arg=arguments[i];arg&&(classes=appendClass(classes,parseValue(arg)))}return classes}function parseValue(arg){if("string"==typeof arg||"number"==typeof arg)return arg;if("object"!=typeof arg)return"";if(Array.isArray(arg))return classNames.apply(null,arg);if(arg.toString!==Object.prototype.toString&&!arg.toString.toString().includes("[native code]"))return arg.toString();var classes="";for(var key in arg)hasOwn.call(arg,key)&&arg[key]&&(classes=appendClass(classes,key));return classes}function appendClass(value,newClass){return newClass?value?value+" "+newClass:value+newClass:value}module.exports?(classNames.default=classNames,module.exports=classNames):void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return classNames}.apply(exports,[]))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()},"./node_modules/convertapi-js/dist/convertapi.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>ConvertApi});class Param{constructor(name,value){this.name=name,this.value=value}get dto(){return Promise.resolve({Name:this.name,Value:this.value})}}class FileValue{constructor(name,fileId){this.name=name,this.fileId=fileId}}class FileParam{constructor(name,file,host){this.name=name,this.file=file,this.host=host}value(){if(this.file instanceof FileValue)return Promise.resolve(this.file.fileId);{let uploadUrl=`https://${this.host}/upload?`;return(this.file instanceof URL?fetch(`${uploadUrl}url=${encodeURIComponent(this.file.href)}`,{method:"POST"}):fetch(`${uploadUrl}filename=${encodeURIComponent(this.file.name)}`,{method:"POST",body:this.file})).then((r=>r.ok?r.json():Promise.reject({Code:5007,Message:"Unable to upload the file"}))).then((obj=>obj.FileId))}}get dto(){return this.value().then((v=>({Name:this.name,FileValue:{Id:v}})))}}class FilesValue{constructor(files){this.files=files}asArray(){return this.files.map((f=>new FileValue(f.FileName,f.FileId)))}}class FilesParam{constructor(name,files,host){this.name=name,this.fileValPros=[],files instanceof FileList?this.fileValPros=Array.from(files).map((f=>new FileParam(name,f,host).value().then((i=>({Id:i}))))):this.fileValPros=files instanceof FilesValue?files.asArray().map((f=>Promise.resolve({Id:f.fileId}))):files.map((f=>Promise.resolve(f instanceof URL?{Url:f.href}:{Id:f})))}get dto(){return Promise.all(this.fileValPros).then((fv=>({Name:this.name,FileValues:fv})))}}class Params{constructor(host,init){let param;this.host=host,this.params=[],init?.forEach((p=>{param=p.isFile?"string"==typeof p.value?new FileParam(p.name,new FileValue("",p.value),this.host):p.value instanceof Array?new FilesParam(p.name,p.value,this.host):param=new FileParam(p.name,p.value,this.host):new Param(p.name,p.value),this.params.push(param)}))}add(name,value){let param;return param=value instanceof FilesValue||value instanceof FileList||value instanceof Array?new FilesParam(name,value,this.host):value instanceof FileValue||value instanceof File||value instanceof URL?new FileParam(name,value,this.host):new Param(name,value),this.params.push(param),param}get(name){return this.params.find((p=>p.name===name))}delete(name){let idx=this.params.findIndex((p=>p.name===name));return this.params.splice(idx,1)[0]}get dto(){let dtoPros=this.params.map((p=>p.dto));return Promise.all(dtoPros).then((ds=>({Parameters:ds})))}}class Result{constructor(dto){this.dto=dto}get duration(){return this.dto.ConversionCost}get files(){return this.dto.Files}toParamFile(idx=0){return new FileValue(this.dto.Files[idx].FileName,this.dto.Files[idx].FileId)}toParamFiles(){return new FilesValue(this.dto.Files)}uploadToS3(region,bucket,accessKeyId,secretAccessKey){return this.dto.Files.map((f=>{let dto={region,bucket,accessKeyId,secretAccessKey,fileId:f.FileId};return fetch("https://integration.convertapi.com/s3/upload",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(dto)})}))}}class ConvertApi{static auth(credentials,host){return new ConvertApi(credentials,host)}constructor(authCredentials,host="v2.convertapi.com"){this.authCredentials=authCredentials,this.host=host}createParams(init){return new Params(this.host,init)}convert(fromFormat,toFormat,params){return Promise.resolve(params.dto).then((dto=>fetch(`https://${this.host}/convert/${fromFormat}/to/${toFormat}?storefile=true`,{method:"POST",headers:{"content-type":"application/json",authorization:`Bearer ${this.authCredentials}`},body:JSON.stringify(dto)}).then((r=>Promise.all([r.ok,r.json()]))).then((([ok,o])=>ok?o:Promise.reject(o))).then((dto=>new Result(dto)))))}}}}]);