"use strict";(self.webpackChunk_memori_ai_memori_react=self.webpackChunk_memori_ai_memori_react||[]).push([[7235],{"./src/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Anonymous:()=>Anonymous,Localhost:()=>Localhost,LocalhostBoE:()=>LocalhostBoE,Staging:()=>Staging,StagingTokenized:()=>StagingTokenized,WithBatch:()=>WithBatch,WithCustomUserAvatar:()=>WithCustomUserAvatar,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),esm=__webpack_require__("./node_modules/@memori.ai/memori-api-client/esm/index.js"),MemoriWidget=__webpack_require__("./src/components/MemoriWidget/MemoriWidget.tsx"),dist=__webpack_require__("./node_modules/react-hot-toast/dist/index.mjs");const defaultTenant={id:"aisuru.com",theme:"aisuru",config:{name:"Memori",showNewUser:!1,requirePosition:!1}};var i18n=__webpack_require__("./src/i18n.ts"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),I18nextProvider=__webpack_require__("./node_modules/react-i18next/dist/es/I18nextProvider.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const Memori=({ownerUserName,ownerUserID,memoriName,memoriID,integrationID,tenantID,secretToken,sessionID,layout="DEFAULT",customLayout,showShare=!0,showSettings=!0,showInstruct=!1,showTypingText=!1,showClear=!1,showOnlyLastMessages=!1,showInputs=!0,showDates=!1,showContextPerLine=!1,showLogin,height="100%",baseURL,apiURL="https://backend.memori.ai",tag,pin,context,initialQuestion,uiLang,spokenLang,multilingual,authToken,AZURE_COGNITIVE_SERVICES_TTS_KEY,defaultSpeakerActive=!0,onStateChange,additionalInfo,customMediaRenderer,additionalSettings,userAvatar})=>{const[memori,setMemori]=(0,react.useState)(),[tenant,setTenant]=(0,react.useState)(),[speechKey,setSpeechKey]=(0,react.useState)(AZURE_COGNITIVE_SERVICES_TTS_KEY),{t}=(0,useTranslation.$)();if(!(memoriID&&ownerUserID||memoriName&&ownerUserName))throw new Error("Identifier pair required: please provide either memoriID and ownerUserID or memoriName and ownerUserName");const client=(0,esm.Z)(apiURL),fetchSpeechKey=(0,react.useCallback)((async()=>{const url=baseURL||(tenantID.startsWith("https://")?tenantID:`https://${tenantID}`),result=await fetch(`${url}/api/speechkey`),data=await result.json();data.AZURE_COGNITIVE_SERVICES_TTS_KEY&&setSpeechKey(data.AZURE_COGNITIVE_SERVICES_TTS_KEY)}),[]);(0,react.useEffect)((()=>{AZURE_COGNITIVE_SERVICES_TTS_KEY||fetchSpeechKey()}),[AZURE_COGNITIVE_SERVICES_TTS_KEY]);const fetchMemori=(0,react.useCallback)((async()=>{if(memoriID&&ownerUserID){const{memori,...resp}=await client.backend.getMemoriByUserAndId(tenantID,ownerUserID,memoriID);0===resp.resultCode&&memori?setMemori(memori):console.error("[MEMORI]",resp,memori)}else if(memoriName&&ownerUserName){const{memori,...resp}=await client.backend.getMemori(tenantID,ownerUserName,memoriName);0===resp.resultCode&&memori?setMemori(memori):console.error("[MEMORI]",resp,memori)}}),[memoriID,ownerUserID,memoriName,ownerUserName,tenantID]);(0,react.useEffect)((()=>{fetchMemori()}),[fetchMemori,tenantID]);const fetchTenant=(0,react.useCallback)((async()=>{const tenant=await(async(tenantID,baseURL)=>{const apiBaseUrl=baseURL?new URL(`${baseURL.startsWith("http")?"":baseURL.includes("localhost")?"http://":"https://"}${baseURL}`).origin:"https://aisuru.com";try{const response=await fetch(`${apiBaseUrl}/api/tenant/${tenantID}`),{tenant}=await response.json();return tenant||{...defaultTenant,tenantID}}catch(error){return{...defaultTenant,tenantID}}})(tenantID,baseURL);tenant&&setTenant(tenant)}),[tenantID,apiURL]);(0,react.useEffect)((()=>{fetchTenant()}),[fetchTenant]),(0,react.useEffect)((()=>{if(uiLang)i18n.Z.changeLanguage(uiLang.toLowerCase());else{const{lng,fallbackLng}=(()=>{const browserLanguage=navigator.language;if(browserLanguage){let lng=browserLanguage.split("-")[0];if(["en","it"].includes(lng))return{lng,fallbackLng:"en"===lng?"it":"en"}}return{lng:"en",fallbackLng:"it"}})();i18n.Z.changeLanguage(lng).catch((()=>{i18n.Z.changeLanguage(fallbackLng)}))}}),[uiLang]);const renderer=memori?(0,jsx_runtime.jsx)(MemoriWidget.Z,{layout,customLayout,height,baseUrl:baseURL||(tenantID.startsWith("https://")?tenantID:`https://${tenantID}`),apiUrl:apiURL,memori:{...memori,secretToken},ownerUserName:ownerUserName??memori.ownerUserName,ownerUserID:ownerUserID??memori.ownerUserID,tenantID,memoriLang:spokenLang??memori.culture?.split("-")?.[0],multilingual,tenant,secret:secretToken,sessionID,showShare,showSettings,showInstruct,showTypingText,showClear,showOnlyLastMessages,showInputs,showDates,showContextPerLine,showLogin:showLogin??memori?.enableDeepThought,integration:memori?.integrations?.find((i=>integrationID?i.integrationID===integrationID:!!i.publish&&"LANDING_EXPERIENCE"===i.type)),initialContextVars:context,initialQuestion,authToken,AZURE_COGNITIVE_SERVICES_TTS_KEY:speechKey||AZURE_COGNITIVE_SERVICES_TTS_KEY,defaultSpeakerActive,onStateChange,additionalInfo,customMediaRenderer,additionalSettings,userAvatar,...tag&&pin?{personification:{tag,pin}}:{}}):(0,jsx_runtime.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,jsx_runtime.jsxs)("p",{style:{textAlign:"center",margin:"2rem auto",textTransform:"capitalize"},children:[t("loading")||"Loading","..."]})});return(0,jsx_runtime.jsxs)(I18nextProvider.a,{i18n:i18n.Z,children:[(0,jsx_runtime.jsx)(dist.x7,{position:"top-center",reverseOrder:!0}),renderer,(0,jsx_runtime.jsx)("script",{dangerouslySetInnerHTML:{__html:"\n          MathJax = {\n            startup: {\n              elements: ['.memori-chat--bubble-content'],\n            },\n            options: {\n              processHtmlClass: 'memori-chat--bubble-content',\n            },\n            tex: {\n              inlineMath: [['$', '$'], ['\\$', '\\$'], ['(',')'], ['(',')'], ['[', ']'], ['[', ']'], ['\\(', '\\)'], ['\\[', '\\]'], ['((','))']],\n              displayMath: [['$$', '$$'], ['\\[[', '\\]]']],\n              processEscapes: true,\n            },\n            asciimath: {\n              fixphi: true,\n              displaystyle: true,\n              decimalsign: '.'\n            },\n            skipStartupTypeset: true,\n            chtml: {\n              displayAlign: 'left',\n            },\n            svg: {\n              fontCache: 'global'\n            }\n          };\n        "}}),(0,jsx_runtime.jsx)("script",{id:"MathJax-script",async:!0,src:"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"})]})};Memori.displayName="Memori",Memori.propTypes={memoriName:prop_types_default().string,memoriID:prop_types_default().string,ownerUserName:prop_types_default().string,ownerUserID:prop_types_default().string,integrationID:prop_types_default().string,tenantID:prop_types_default().string.isRequired,secretToken:prop_types_default().string,sessionID:prop_types_default().string,layout:prop_types_default().oneOf(["DEFAULT","FULLPAGE","TOTEM","WEBSITE_ASSISTANT","CHAT"]),customLayout:prop_types_default().any,showShare:prop_types_default().bool,showInstruct:prop_types_default().bool,showInputs:prop_types_default().bool,showDates:prop_types_default().bool,showContextPerLine:prop_types_default().bool,showSettings:prop_types_default().bool,showClear:prop_types_default().bool,showOnlyLastMessages:prop_types_default().bool,showTypingText:prop_types_default().bool,showLogin:prop_types_default().bool,height:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().number]),baseURL:prop_types_default().string,apiURL:prop_types_default().string,tag:prop_types_default().string,pin:prop_types_default().string,context:prop_types_default().objectOf(prop_types_default().any),initialQuestion:prop_types_default().string,uiLang:prop_types_default().oneOf(["en","it","EN","IT"]),spokenLang:prop_types_default().string,multilingual:prop_types_default().bool,authToken:prop_types_default().string,AZURE_COGNITIVE_SERVICES_TTS_KEY:prop_types_default().string,defaultSpeakerActive:prop_types_default().bool,onStateChange:prop_types_default().func,additionalInfo:prop_types_default().objectOf(prop_types_default().any),customMediaRenderer:prop_types_default().func,additionalSettings:prop_types_default().any,userAvatar:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().any])};const src_0=Memori;try{src.displayName="src",src.__docgenInfo={description:"",displayName:"src",props:{memoriName:{defaultValue:null,description:"",name:"memoriName",required:!1,type:{name:"string | null"}},memoriID:{defaultValue:null,description:"",name:"memoriID",required:!1,type:{name:"string | null"}},ownerUserName:{defaultValue:null,description:"",name:"ownerUserName",required:!1,type:{name:"string | null"}},ownerUserID:{defaultValue:null,description:"",name:"ownerUserID",required:!1,type:{name:"string | null"}},integrationID:{defaultValue:null,description:"",name:"integrationID",required:!1,type:{name:"string"}},tenantID:{defaultValue:null,description:"",name:"tenantID",required:!0,type:{name:"string"}},secretToken:{defaultValue:null,description:"",name:"secretToken",required:!1,type:{name:"string"}},sessionID:{defaultValue:null,description:"",name:"sessionID",required:!1,type:{name:"string"}},layout:{defaultValue:{value:"DEFAULT"},description:"",name:"layout",required:!1,type:{name:"enum",value:[{value:'"DEFAULT"'},{value:'"FULLPAGE"'},{value:'"TOTEM"'},{value:'"CHAT"'},{value:'"WEBSITE_ASSISTANT"'}]}},customLayout:{defaultValue:null,description:"",name:"customLayout",required:!1,type:{name:"FC<LayoutProps>"}},showShare:{defaultValue:{value:"true"},description:"",name:"showShare",required:!1,type:{name:"boolean"}},showInstruct:{defaultValue:{value:"false"},description:"",name:"showInstruct",required:!1,type:{name:"boolean"}},showInputs:{defaultValue:{value:"true"},description:"",name:"showInputs",required:!1,type:{name:"boolean"}},showDates:{defaultValue:{value:"false"},description:"",name:"showDates",required:!1,type:{name:"boolean"}},showContextPerLine:{defaultValue:{value:"false"},description:"",name:"showContextPerLine",required:!1,type:{name:"boolean"}},showSettings:{defaultValue:{value:"true"},description:"",name:"showSettings",required:!1,type:{name:"boolean"}},showClear:{defaultValue:{value:"false"},description:"",name:"showClear",required:!1,type:{name:"boolean"}},showOnlyLastMessages:{defaultValue:{value:"false"},description:"",name:"showOnlyLastMessages",required:!1,type:{name:"boolean"}},showTypingText:{defaultValue:{value:"false"},description:"",name:"showTypingText",required:!1,type:{name:"boolean"}},showLogin:{defaultValue:null,description:"",name:"showLogin",required:!1,type:{name:"boolean"}},height:{defaultValue:{value:"100%"},description:"",name:"height",required:!1,type:{name:"string | number"}},baseURL:{defaultValue:null,description:"",name:"baseURL",required:!1,type:{name:"string"}},apiURL:{defaultValue:{value:"https://backend.memori.ai"},description:"",name:"apiURL",required:!1,type:{name:"string"}},tag:{defaultValue:null,description:"",name:"tag",required:!1,type:{name:"string"}},pin:{defaultValue:null,description:"",name:"pin",required:!1,type:{name:"string"}},context:{defaultValue:null,description:"",name:"context",required:!1,type:{name:"{ [key: string]: string; }"}},initialQuestion:{defaultValue:null,description:"",name:"initialQuestion",required:!1,type:{name:"string"}},uiLang:{defaultValue:null,description:"",name:"uiLang",required:!1,type:{name:"enum",value:[{value:'"en"'},{value:'"it"'},{value:'"IT"'},{value:'"EN"'}]}},spokenLang:{defaultValue:null,description:"",name:"spokenLang",required:!1,type:{name:"string"}},multilingual:{defaultValue:null,description:"",name:"multilingual",required:!1,type:{name:"boolean"}},authToken:{defaultValue:null,description:"",name:"authToken",required:!1,type:{name:"string"}},defaultSpeakerActive:{defaultValue:{value:"true"},description:"",name:"defaultSpeakerActive",required:!1,type:{name:"boolean"}},AZURE_COGNITIVE_SERVICES_TTS_KEY:{defaultValue:null,description:"",name:"AZURE_COGNITIVE_SERVICES_TTS_KEY",required:!1,type:{name:"string"}},onStateChange:{defaultValue:null,description:"",name:"onStateChange",required:!1,type:{name:"((state?: DialogState) => void)"}},additionalInfo:{defaultValue:null,description:"",name:"additionalInfo",required:!1,type:{name:"({ loginToken?: string; language?: string; referral?: string | undefined; } & { [key: string]: string; }) | undefined"}},customMediaRenderer:{defaultValue:null,description:"",name:"customMediaRenderer",required:!1,type:{name:"((mimeType: string) => Element | null)"}},additionalSettings:{defaultValue:null,description:"",name:"additionalSettings",required:!1,type:{name:"Element | null"}},userAvatar:{defaultValue:null,description:"",name:"userAvatar",required:!1,type:{name:"string | Element"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/index.tsx#src"]={docgenInfo:src.__docgenInfo,name:"src",path:"src/index.tsx#src"})}catch(__react_docgen_typescript_loader_error){}const index_stories={title:"General/Default",component:src_0,argTypes:{AZURE_COGNITIVE_SERVICES_TTS_KEY:{control:{type:"text"}}},parameters:{controls:{expanded:!0},layout:"fullscreen"}},Template=args=>(0,jsx_runtime.jsx)(src_0,{...args});Template.displayName="Template";const Anonymous=Template.bind({});Anonymous.args={ownerUserName:"nzambello",memoriName:"Nicola",tenantID:"aisuru.com",apiURL:"https://backend.memori.ai",baseURL:"https://aisuru.com",uiLang:"it",showShare:!0,showSettings:!0};const Localhost=Template.bind({});Localhost.args={memoriName:"test memori",ownerUserName:"nicola",memoriID:"1a9c75e8-57aa-4ce3-8ea5-256185fa79a7",ownerUserID:"04a8cff9-13d6-4367-9cb2-72b9af9ee494",tenantID:"app.memorytwin.com",apiURL:"http://localhost:7778",baseURL:"http://localhost:3000",uiLang:"EN",lang:"IT",layout:"FULLPAGE",showShare:!0,integrationID:"82f017cc-450b-4c47-acf5-47910d336ce9"};const LocalhostBoE=Template.bind({});LocalhostBoE.args={memoriName:"experts chairman",ownerUserName:"nicola",memoriID:"2b094cd6-77b8-4e09-a807-0039b84c988e",ownerUserID:"04a8cff9-13d6-4367-9cb2-72b9af9ee494",tenantID:"app.memorytwin.com",apiURL:"http://localhost:7778",baseURL:"http://localhost:3000",uiLang:"EN",lang:"IT",layout:"FULLPAGE",showShare:!0,integrationID:"82f017cc-450b-4c47-acf5-47910d336ce9"};const Staging=Template.bind({});Staging.args={memoriName:"Giuseppe Verdi",ownerUserName:"nunziofiore",memoriID:"b996dbb9-3728-44d6-96f7-9b728224698c",ownerUserID:"fbee9aaa-0c46-460e-9800-15e31d7c99c0",tenantID:"aisuru-staging.aclambda.online",apiURL:"https://backend-staging.memori.ai",baseURL:"https://aisuru-staging.aclambda.online",uiLang:"EN",lang:"IT",layout:"FULLPAGE"};const StagingTokenized=Template.bind({});StagingTokenized.args={memoriName:"Test",ownerUserName:"nicola",memoriID:"36798f8a-7018-4cf7-9be4-e681949a46a3",ownerUserID:"585ec0ff-e805-495e-b8fc-5b0b8dd288ff",tenantID:"aisuru-staging-tokenized.aclambda.online",apiURL:"https://backend-staging.memori.ai",baseURL:"https://aisuru-staging-tokenized.aclambda.online",uiLang:"EN",lang:"IT",layout:"FULLPAGE"};const TemplateWithBatchButton=args=>(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("button",{style:{position:"fixed",top:"0.5rem",left:"0.5rem",zIndex:99999},onClick:()=>{window.typeBatchMessages([{message:"uno di tre",hidden:!1,waitForPrevious:!0},{message:"due di tre",hidden:!1,waitForPrevious:!0},{message:"tre di tre",hidden:!1,waitForPrevious:!0}])},children:"Start Batch"}),(0,jsx_runtime.jsx)(src_0,{...args})]});TemplateWithBatchButton.displayName="TemplateWithBatchButton";const WithBatch=TemplateWithBatchButton.bind({});WithBatch.args={ownerUserName:"nzambello",memoriName:"Nicola",tenantID:"aisuru.com",apiURL:"https://backend.memori.ai",baseURL:"https://aisuru.com",uiLang:"it",showShare:!0,showSettings:!0};const WithCustomUserAvatar=Template.bind({});WithCustomUserAvatar.args={ownerUserName:"nzambello",memoriName:"Nicola",tenantID:"aisuru.com",apiURL:"https://backend.memori.ai",baseURL:"https://aisuru.com",uiLang:"it",showShare:!0,showSettings:!0,userAvatar:"https://picsum.photos/200"},Anonymous.parameters={...Anonymous.parameters,docs:{...Anonymous.parameters?.docs,source:{originalSource:"args => <Memori {...args} />",...Anonymous.parameters?.docs?.source}}},Localhost.parameters={...Localhost.parameters,docs:{...Localhost.parameters?.docs,source:{originalSource:"args => <Memori {...args} />",...Localhost.parameters?.docs?.source}}},LocalhostBoE.parameters={...LocalhostBoE.parameters,docs:{...LocalhostBoE.parameters?.docs,source:{originalSource:"args => <Memori {...args} />",...LocalhostBoE.parameters?.docs?.source}}},Staging.parameters={...Staging.parameters,docs:{...Staging.parameters?.docs,source:{originalSource:"args => <Memori {...args} />",...Staging.parameters?.docs?.source}}},StagingTokenized.parameters={...StagingTokenized.parameters,docs:{...StagingTokenized.parameters?.docs,source:{originalSource:"args => <Memori {...args} />",...StagingTokenized.parameters?.docs?.source}}},WithBatch.parameters={...WithBatch.parameters,docs:{...WithBatch.parameters?.docs,source:{originalSource:"args => <div>\n    <button style={{\n    position: 'fixed',\n    top: '0.5rem',\n    left: '0.5rem',\n    zIndex: 99999\n  }} onClick={() => {\n    window.typeBatchMessages([{\n      message: 'uno di tre',\n      hidden: false,\n      waitForPrevious: true\n    }, {\n      message: 'due di tre',\n      hidden: false,\n      waitForPrevious: true\n    }, {\n      message: 'tre di tre',\n      hidden: false,\n      waitForPrevious: true\n    }]);\n  }}>\n      Start Batch\n    </button>\n    <Memori {...args} />\n  </div>",...WithBatch.parameters?.docs?.source}}},WithCustomUserAvatar.parameters={...WithCustomUserAvatar.parameters,docs:{...WithCustomUserAvatar.parameters?.docs,source:{originalSource:"args => <Memori {...args} />",...WithCustomUserAvatar.parameters?.docs?.source}}};const __namedExportsOrder=["Anonymous","Localhost","LocalhostBoE","Staging","StagingTokenized","WithBatch","WithCustomUserAvatar"]}}]);