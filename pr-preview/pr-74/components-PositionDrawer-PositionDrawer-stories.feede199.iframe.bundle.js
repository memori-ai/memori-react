"use strict";(self.webpackChunk_memori_ai_memori_react=self.webpackChunk_memori_ai_memori_react||[]).push([[2985],{"./src/components/PositionDrawer/PositionDrawer.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,WithVenue:()=>WithVenue,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_I18nWrapper__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/I18nWrapper.tsx"),_PositionDrawer__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/PositionDrawer/PositionDrawer.tsx"),_mocks_data__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/mocks/data.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__={title:"Widget/PositionDrawer",component:_PositionDrawer__WEBPACK_IMPORTED_MODULE_2__.A,argTypes:{open:{control:{type:"boolean"}}},parameters:{controls:{expanded:!0}}},Template=args=>{const[venue,setVenue]=react__WEBPACK_IMPORTED_MODULE_0__.useState(args.venue);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_I18nWrapper__WEBPACK_IMPORTED_MODULE_1__.A,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_PositionDrawer__WEBPACK_IMPORTED_MODULE_2__.A,{...args,memori:_mocks_data__WEBPACK_IMPORTED_MODULE_3__.mn,venue,setVenue})})};Template.displayName="Template";const Default=Template.bind({});Default.args={open:!0};const WithVenue=Template.bind({});WithVenue.args={open:!0,venue:_mocks_data__WEBPACK_IMPORTED_MODULE_3__.gD},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => {\n  const [venue, setVenue] = React.useState<Venue | undefined>(args.venue);\n  return <I18nWrapper>\n      <PositionDrawer {...args} memori={memori} venue={venue} setVenue={setVenue} />\n    </I18nWrapper>;\n}",...Default.parameters?.docs?.source}}},WithVenue.parameters={...WithVenue.parameters,docs:{...WithVenue.parameters?.docs,source:{originalSource:"args => {\n  const [venue, setVenue] = React.useState<Venue | undefined>(args.venue);\n  return <I18nWrapper>\n      <PositionDrawer {...args} memori={memori} venue={venue} setVenue={setVenue} />\n    </I18nWrapper>;\n}",...WithVenue.parameters?.docs?.source}}};const __namedExportsOrder=["Default","WithVenue"]},"./src/components/PositionDrawer/PositionDrawer.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _ui_Drawer__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/ui/Drawer.tsx"),react_i18next__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),_VenueWidget_VenueWidget__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/VenueWidget/VenueWidget.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");const PositionDrawer=({memori,open,onClose,venue,setVenue})=>{const{t}=(0,react_i18next__WEBPACK_IMPORTED_MODULE_2__.B)();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(_ui_Drawer__WEBPACK_IMPORTED_MODULE_1__.A,{className:"memori-position-drawer",open,onClose:()=>onClose(venue),title:t("widget.position")||"Position",animated:!1,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("p",{children:t("write_and_speak.requirePositionHelp",{name:memori.name})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_VenueWidget_VenueWidget__WEBPACK_IMPORTED_MODULE_3__.A,{venue,setVenue,showUncertainty:!1,saveAndClose:venue=>{setVenue(venue),onClose(venue)}})]})};PositionDrawer.displayName="PositionDrawer";const __WEBPACK_DEFAULT_EXPORT__=PositionDrawer;try{PositionDrawer.displayName="PositionDrawer",PositionDrawer.__docgenInfo={description:"",displayName:"PositionDrawer",props:{memori:{defaultValue:null,description:"",name:"memori",required:!0,type:{name:"Memori"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"(venue?: Venue | undefined) => void"}},venue:{defaultValue:null,description:"",name:"venue",required:!1,type:{name:"Venue"}},setVenue:{defaultValue:null,description:"",name:"setVenue",required:!0,type:{name:"(venue: Venue) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/PositionDrawer/PositionDrawer.tsx#PositionDrawer"]={docgenInfo:PositionDrawer.__docgenInfo,name:"PositionDrawer",path:"src/components/PositionDrawer/PositionDrawer.tsx#PositionDrawer"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/VenueWidget/VenueWidget.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>VenueWidget_VenueWidget});var react=__webpack_require__("./node_modules/react/index.js"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js");const DEGREES_TO_RADIANS=Math.PI/180,getUncertaintyByViewport=bouningBox=>{const[minLat,maxLat,minLng,maxLng]="string"==typeof bouningBox[0]?bouningBox.map(parseFloat):bouningBox,phi1=minLat*DEGREES_TO_RADIANS,lambda1=minLng*DEGREES_TO_RADIANS,phi2=maxLat*DEGREES_TO_RADIANS,lambda2=maxLng*DEGREES_TO_RADIANS;return 6367.5*(2*Math.asin(Math.sqrt(Math.sin((phi2-phi1)/2)*Math.sin((phi2-phi1)/2)+Math.cos(phi1)*Math.cos(phi2)*Math.sin((lambda2-lambda1)/2)*Math.sin((lambda2-lambda1)/2))))};var hooks=__webpack_require__("./node_modules/react-leaflet/lib/hooks.js"),MapContainer=__webpack_require__("./node_modules/react-leaflet/lib/MapContainer.js"),TileLayer=__webpack_require__("./node_modules/react-leaflet/lib/TileLayer.js"),Marker=__webpack_require__("./node_modules/react-leaflet/lib/Marker.js"),Popup=__webpack_require__("./node_modules/react-leaflet/lib/Popup.js"),lib_context=__webpack_require__("./node_modules/@react-leaflet/core/lib/context.js"),leaflet_src=__webpack_require__("./node_modules/leaflet/dist/leaflet-src.js"),leaflet_src_default=__webpack_require__.n(leaflet_src),dist=__webpack_require__("./node_modules/react-hot-toast/dist/index.mjs"),Button=__webpack_require__("./src/components/ui/Button.tsx"),utils=__webpack_require__("./src/helpers/utils.ts"),combobox=__webpack_require__("./node_modules/@headlessui/react/dist/components/combobox/combobox.js"),transition=__webpack_require__("./node_modules/@headlessui/react/dist/components/transitions/transition.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),Spin=__webpack_require__("./src/components/ui/Spin.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const Circle=({center,size})=>{const context=(0,lib_context.U$)();return(0,react.useEffect)(()=>{const square=new(leaflet_src_default().Circle)(center,size),container=context.layerContainer||context.map;return container.addLayer(square),()=>{container.removeLayer(square)}}),null},CenterAndZoomUpdater=({center,uncertainty})=>{const[init,setInit]=(0,react.useState)(!1),map=(0,hooks.ko)(),updateView=(0,react.useCallback)(()=>{let zoom=void 0!==uncertainty?Math.round(Math.log2(1e7/uncertainty)):map.getZoom();map.setView(center,zoom)},[center,uncertainty,map]);return(0,react.useEffect)(()=>{init||(updateView(),setInit(!0))},[]),(0,react.useEffect)(()=>{updateView()},[center,uncertainty,updateView]),null};let DefaultIcon=leaflet_src_default().icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12.5,20.5],shadowAnchor:[12.5,20.5]});leaflet_src_default().Marker.prototype.options.icon=DefaultIcon;const getPlaceName=venue=>{let placeName="Position";return venue?.address?placeName=[venue.address.village||venue.address.suburb,venue.address.town||venue.address.city||venue.address.county||venue.address.state,venue.address.country].filter(Boolean).filter((v,i,a)=>a.indexOf(v)===i).join(", "):venue?.display_name&&(placeName=venue.display_name),placeName},VenueWidget=({venue,setVenue,showUncertainty=!1,showGpsButton=!0,saveAndClose})=>{const{t}=(0,useTranslation.B)(),[isClient,setIsClient]=(0,react.useState)(!1),[updatingPosition,setUpdatingPosition]=(0,react.useState)(!1),[fetching,setFetching]=(0,react.useState)(!1),[query,setQuery]=(0,react.useState)(""),[suggestions,setSuggestions]=(0,react.useState)([]),handleSearch=(0,utils.xD)(async value=>{setFetching(!0);try{let response=await fetch(`https://nominatim.openstreetmap.org/search?q=${value}&format=jsonv2&limit=5&addressdetails=1`),data=await response.json();setSuggestions(data)}catch(error){console.error(error)}finally{setFetching(!1)}},1e3);return(0,react.useEffect)(()=>{setIsClient(!0)},[]),(0,react.useEffect)(()=>{const leafletCSS=document.createElement("link");return leafletCSS.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",leafletCSS.rel="stylesheet",leafletCSS.integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=",leafletCSS.crossOrigin="",document.head.appendChild(leafletCSS),()=>{document.head.removeChild(leafletCSS)}},[]),(0,jsx_runtime.jsxs)("fieldset",{className:"memori--venue-widget",children:[(0,jsx_runtime.jsx)("legend",{className:"sr-only",children:"Venue"}),(0,jsx_runtime.jsxs)("div",{className:"memori--venue-widget__form-item",children:[(0,jsx_runtime.jsx)("div",{className:"memori--venue-widget__geosuggest",children:updatingPosition?(0,jsx_runtime.jsx)("p",{children:t("write_and_speak.updatingPosition")}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"memori--venue-widget-search",children:(0,jsx_runtime.jsxs)(combobox.G,{value:venue?.latitude&&venue?.longitude?{place_id:0,lat:venue?.latitude,lon:venue?.longitude,display_name:venue?.placeName}:void 0,onChange:value=>{console.log(value);const placeName=getPlaceName(value);setVenue({latitude:value.lat,longitude:value.lon,placeName,uncertainty:value?.boundingbox?getUncertaintyByViewport(value.boundingbox):2})},children:[(0,jsx_runtime.jsx)(combobox.G.Input,{className:"memori--venue-widget-search--input",displayValue:i=>i?getPlaceName(i):"",placeholder:t("searchVenue"),onChange:e=>{return value=e.target.value,setQuery(value),void handleSearch(value);var value}}),(fetching||suggestions.length>0||0===suggestions.length&&""!==query)&&(0,jsx_runtime.jsx)(transition.e,{as:react.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,jsx_runtime.jsx)(combobox.G.Options,{className:"memori--venue-widget-search--options",children:fetching?(0,jsx_runtime.jsx)(Spin.A,{spinning:!0,children:(0,jsx_runtime.jsxs)("div",{className:"memori--venue-widget-search--option memori--venue-widget-search--option-centered",children:[t("loading"),"..."]})}):0===suggestions.length&&""!==query?(0,jsx_runtime.jsx)("div",{className:"memori--venue-widget-search--option memori--venue-widget-search--option-centered",children:t("nothingFound")}):suggestions?.map(s=>(0,jsx_runtime.jsx)(combobox.G.Option,{as:react.Fragment,value:s,children:({active,selected})=>(0,jsx_runtime.jsx)("li",{className:classnames_default()("memori--venue-widget-search--option",{"memori--venue-widget-search--option-active":active,"memori--venue-widget-search--option-selected":selected}),children:s.display_name})},s.place_id))})})]})}),showGpsButton&&(0,jsx_runtime.jsx)(Button.A,{className:"memori--venue-widget__gps-button",primary:!0,loading:updatingPosition,onClick:()=>{setUpdatingPosition(!0),(async()=>{setUpdatingPosition(!0),navigator.geolocation.getCurrentPosition(async coords=>{let venue={latitude:coords.coords.latitude,longitude:coords.coords.longitude,placeName:"Position",uncertainty:coords.coords.accuracy/1e3};try{const result=await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${coords.coords.latitude}&lon=${coords.coords.longitude}&format=jsonv2&addressdetails=1`),response=await result.json(),placeName=getPlaceName(response);venue={latitude:coords.coords.latitude,longitude:coords.coords.longitude,placeName,uncertainty:coords.coords.accuracy/1e3},setVenue(venue)}catch(e){let err=e;console.error("[POSITION ERROR]",err),err?.message&&dist.Ay.error(err.message),setVenue(venue)}finally{saveAndClose&&saveAndClose(venue)}setUpdatingPosition(!1)},err=>{console.error("[POSITION ERROR]",err),dist.Ay.error(err.message),setUpdatingPosition(!1)})})()},children:t("write_and_speak.useMyPosition")})]})}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(Button.A,{outlined:!0,className:"memori--venue-widget__no-location-button",onClick:()=>{let venue={latitude:0,longitude:0,placeName:"Position",uncertainty:0};setVenue(venue),saveAndClose&&saveAndClose(venue)},children:t("write_and_speak.dontWantToProvidePosition")})}),showUncertainty&&(0,jsx_runtime.jsxs)("label",{className:"memori--venue-widget__select-label",children:[(0,jsx_runtime.jsxs)("span",{children:[t("uncertain"),": "]}),(0,jsx_runtime.jsxs)("select",{className:"memori-select--button memori--venue-widget__uncertainty",value:parseFloat((venue?.uncertainty??0).toFixed(2)),disabled:!(venue&&venue.placeName&&venue.latitude&&venue.longitude),onChange:e=>{setVenue({...venue,uncertainty:parseFloat(e.target.value)})},children:[venue?.uncertainty&&![0,1,2,5,10,20,50,100].includes(venue.uncertainty)&&(0,jsx_runtime.jsxs)("option",{value:venue.uncertainty,children:[venue.uncertainty," Km"]}),(0,jsx_runtime.jsx)("option",{value:0,children:t("exactPosition")}),(0,jsx_runtime.jsx)("option",{value:1,children:"1 km"}),(0,jsx_runtime.jsx)("option",{value:2,children:"2 km"}),(0,jsx_runtime.jsx)("option",{value:5,children:"5 km"}),(0,jsx_runtime.jsx)("option",{value:10,children:"10 km"}),(0,jsx_runtime.jsx)("option",{value:20,children:"20 km"}),(0,jsx_runtime.jsx)("option",{value:50,children:"50 km"}),(0,jsx_runtime.jsx)("option",{value:100,children:"100 km"})]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"memori--venue-widget__form-item",children:[venue?.placeName&&"Position"!==venue.placeName&&(0,jsx_runtime.jsxs)("p",{className:"memori--venue--widget__place-name",children:[(0,jsx_runtime.jsx)("strong",{children:t("venue")}),": ",venue.placeName]}),(0,jsx_runtime.jsx)("div",{className:"memori--venue-widget__map",children:isClient&&(0,jsx_runtime.jsxs)(MapContainer.W,{className:"memori--venue-widget__map",center:venue?.latitude&&venue?.longitude?[venue.latitude,venue.longitude]:[44.66579,11.48823],zoom:13,scrollWheelZoom:!0,children:[(0,jsx_runtime.jsx)(TileLayer.e,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,jsx_runtime.jsx)(CenterAndZoomUpdater,{center:venue?.latitude&&venue?.longitude?[venue.latitude,venue.longitude]:[44.66579,11.48823],uncertainty:1e3*(venue?.uncertainty??0)}),venue?.latitude&&venue?.longitude&&(0,jsx_runtime.jsx)(Marker.p,{position:[venue.latitude,venue.longitude],icon:DefaultIcon,children:(0,jsx_runtime.jsx)(Popup.z,{children:venue.placeName??""})}),venue?.latitude&&venue?.longitude&&void 0!==venue?.uncertainty&&(0,jsx_runtime.jsx)(Circle,{center:[venue.latitude,venue.longitude],size:1e3*venue.uncertainty})]})})]})]})};VenueWidget.displayName="VenueWidget";const VenueWidget_VenueWidget=VenueWidget;try{VenueWidget.displayName="VenueWidget",VenueWidget.__docgenInfo={description:"",displayName:"VenueWidget",props:{venue:{defaultValue:null,description:"",name:"venue",required:!1,type:{name:"Venue"}},setVenue:{defaultValue:null,description:"",name:"setVenue",required:!0,type:{name:"(venue: Venue) => void"}},showUncertainty:{defaultValue:{value:"false"},description:"",name:"showUncertainty",required:!1,type:{name:"boolean"}},showGpsButton:{defaultValue:{value:"true"},description:"",name:"showGpsButton",required:!1,type:{name:"boolean"}},saveAndClose:{defaultValue:null,description:"",name:"saveAndClose",required:!1,type:{name:"((venue: Venue) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/VenueWidget/VenueWidget.tsx#VenueWidget"]={docgenInfo:VenueWidget.__docgenInfo,name:"VenueWidget",path:"src/components/VenueWidget/VenueWidget.tsx#VenueWidget"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/icons/Close.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Close=({className,title})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("svg",{...title?{}:{"aria-hidden":"true"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",focusable:"false",role:"img",className,"aria-label":title,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("path",{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"})});Close.displayName="Close";const __WEBPACK_DEFAULT_EXPORT__=Close;try{Close.displayName="Close",Close.__docgenInfo={description:"",displayName:"Close",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/icons/Close.tsx#Close"]={docgenInfo:Close.__docgenInfo,name:"Close",path:"src/components/icons/Close.tsx#Close"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/ui/ConfirmDialog.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_headlessui_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@headlessui/react/dist/components/dialog/dialog.js"),_headlessui_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@headlessui/react/dist/components/transitions/transition.js"),_Button__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/ui/Button.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");const ConfirmDialog=({isOpen,onClose,onConfirm,title,message,confirmText,cancelText})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_headlessui_react__WEBPACK_IMPORTED_MODULE_2__.e,{appear:!0,show:isOpen,as:react__WEBPACK_IMPORTED_MODULE_0__.Fragment,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(_headlessui_react__WEBPACK_IMPORTED_MODULE_1__.l,{as:"div",className:"memori-confirm-dialog",onClose,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"memori-confirm-dialog--backdrop"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"memori-confirm-dialog--container",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_headlessui_react__WEBPACK_IMPORTED_MODULE_2__.e.Child,{as:react__WEBPACK_IMPORTED_MODULE_0__.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(_headlessui_react__WEBPACK_IMPORTED_MODULE_1__.l.Panel,{className:"memori-confirm-dialog--panel",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_headlessui_react__WEBPACK_IMPORTED_MODULE_1__.l.Title,{className:"memori-confirm-dialog--title",children:title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_headlessui_react__WEBPACK_IMPORTED_MODULE_1__.l.Description,{className:"memori-confirm-dialog--message",children:message}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"memori-confirm-dialog--actions",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_3__.A,{onClick:onClose,children:cancelText}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_3__.A,{primary:!0,onClick:onConfirm,children:confirmText})]})]})})})]})});ConfirmDialog.displayName="ConfirmDialog";const __WEBPACK_DEFAULT_EXPORT__=ConfirmDialog;try{ConfirmDialog.displayName="ConfirmDialog",ConfirmDialog.__docgenInfo={description:"",displayName:"ConfirmDialog",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},onConfirm:{defaultValue:null,description:"",name:"onConfirm",required:!0,type:{name:"() => void"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},message:{defaultValue:null,description:"",name:"message",required:!0,type:{name:"string"}},confirmText:{defaultValue:null,description:"",name:"confirmText",required:!0,type:{name:"string"}},cancelText:{defaultValue:null,description:"",name:"cancelText",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/ConfirmDialog.tsx#ConfirmDialog"]={docgenInfo:ConfirmDialog.__docgenInfo,name:"ConfirmDialog",path:"src/components/ui/ConfirmDialog.tsx#ConfirmDialog"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/ui/Drawer.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_headlessui_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@headlessui/react/dist/components/dialog/dialog.js"),_headlessui_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@headlessui/react/dist/components/transitions/transition.js"),_Spin__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/ui/Spin.tsx"),_Button__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/ui/Button.tsx"),_icons_Close__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/icons/Close.tsx"),classnames__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_6__),react_i18next__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),_ConfirmDialog__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/components/ui/ConfirmDialog.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Drawer=({title,open=!1,data,onClose=()=>{},children,width="80%",footer,extra,className,placement="right",description,loading=!1,animated=!0,closable=!0,widthMd="80%",widthLg="60%",confirmDialogTitle,confirmDialogMessage})=>{const[originalData,setOriginalData]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),[confirmDialogOpen,setConfirmDialogOpen]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),{t}=(0,react_i18next__WEBPACK_IMPORTED_MODULE_7__.B)();(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{open&&data&&!originalData&&setOriginalData(data),open||setOriginalData(null)},[open,data,originalData]);const checkChanges=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{if(!data||0===Object.keys(data).length)return onClose();originalData&&JSON.stringify(originalData)!==JSON.stringify(data)?setConfirmDialogOpen(!0):onClose()},[data,originalData,onClose]),handleClose=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{checkChanges()},[checkChanges]),handleConfirmUnsavedChanges=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{setConfirmDialogOpen(!1),onClose()},[onClose]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ConfirmDialog__WEBPACK_IMPORTED_MODULE_8__.A,{isOpen:confirmDialogOpen,onClose:()=>setConfirmDialogOpen(!1),onConfirm:handleConfirmUnsavedChanges,title:confirmDialogTitle||t("confirmDialog.title"),message:confirmDialogMessage||t("confirmDialog.message"),confirmText:t("confirm")||"Confirm",cancelText:t("cancel")||"Cancel"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_headlessui_react__WEBPACK_IMPORTED_MODULE_2__.e,{appear:!0,show:open,as:react__WEBPACK_IMPORTED_MODULE_0__.Fragment,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(_headlessui_react__WEBPACK_IMPORTED_MODULE_1__.l,{open,onClose:handleClose,className:classnames__WEBPACK_IMPORTED_MODULE_6___default()("memori-drawer",className),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_headlessui_react__WEBPACK_IMPORTED_MODULE_2__.e.Child,{as:react__WEBPACK_IMPORTED_MODULE_0__.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-drawer--backdrop"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-drawer--container",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-drawer--container-scrollable",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_headlessui_react__WEBPACK_IMPORTED_MODULE_2__.e.Child,{static:!0,as:react__WEBPACK_IMPORTED_MODULE_0__.Fragment,enter:"ease-out duration-300",enterFrom:animated?"max-w-0 opacity-0":"opacity-0",enterTo:"max-w-80 opacity-100",leave:"ease-in duration-200",leaveFrom:"max-w-80 opacity-100",leaveTo:animated?"max-w-0 opacity-0":"opacity-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(_headlessui_react__WEBPACK_IMPORTED_MODULE_1__.l.Panel,{className:classnames__WEBPACK_IMPORTED_MODULE_6___default()("memori-drawer--panel",{"memori-drawer--panel-left":"left"===placement,"memori-drawer--with-footer":!!footer}),style:{"--memori-drawer--width":width,"--memori-drawer--width--lg":widthLg,"--memori-drawer--width--md":widthMd},children:[closable&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-drawer--close",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_4__.A,{shape:"circle",outlined:!0,icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_icons_Close__WEBPACK_IMPORTED_MODULE_5__.default,{}),onClick:handleClose})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Spin__WEBPACK_IMPORTED_MODULE_3__.A,{spinning:loading,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-drawer--content",children:[title&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_headlessui_react__WEBPACK_IMPORTED_MODULE_1__.l.Title,{className:"memori-drawer--title",children:title}),description&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_headlessui_react__WEBPACK_IMPORTED_MODULE_1__.l.Description,{className:"memori-drawer--description",children:description}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-drawer--content--scrollable",children})]})}),footer&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-drawer--footer",children:[footer.leftAction&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-drawer--footer-left-action "+(footer.leftActionClassName||""),children:footer.leftAction}),footer.onSubmit&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"memori-drawer--footer-actions",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_4__.A,{outlined:!0,onClick:handleClose,children:t("cancel")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_4__.A,{htmlType:"submit",onClick:footer.onSubmit,loading:footer.loading,className:"memori-drawer--footer-confirm",children:t("confirm")})]}),extra&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"memori-drawer--extra",children:extra})]})]})})})})]})})]})};Drawer.displayName="Drawer";const __WEBPACK_DEFAULT_EXPORT__=Drawer;try{Drawer.displayName="Drawer",Drawer.__docgenInfo={description:"",displayName:"Drawer",props:{title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"ReactNode"}},open:{defaultValue:{value:"false"},description:"",name:"open",required:!1,type:{name:"boolean"}},data:{defaultValue:null,description:"",name:"data",required:!1,type:{name:"any"}},onClose:{defaultValue:{value:"() => {}"},description:"",name:"onClose",required:!1,type:{name:"(() => void)"}},width:{defaultValue:{value:"80%"},description:"",name:"width",required:!1,type:{name:"string | number"}},footer:{defaultValue:null,description:"",name:"footer",required:!1,type:{name:"{ leftAction?: ReactNode; leftActionClassName?: string; onSubmit?: (() => void); loading?: boolean | undefined; } | undefined"}},extra:{defaultValue:null,description:"",name:"extra",required:!1,type:{name:"ReactNode"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},placement:{defaultValue:{value:"right"},description:"",name:"placement",required:!1,type:{name:"enum",value:[{value:'"left"'},{value:'"right"'}]}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"Element | ReactNode"}},loading:{defaultValue:{value:"false"},description:"",name:"loading",required:!1,type:{name:"boolean"}},animated:{defaultValue:{value:"true"},description:"",name:"animated",required:!1,type:{name:"boolean"}},closable:{defaultValue:{value:"true"},description:"",name:"closable",required:!1,type:{name:"boolean"}},widthMd:{defaultValue:{value:"80%"},description:"",name:"widthMd",required:!1,type:{name:"string"}},widthLg:{defaultValue:{value:"60%"},description:"",name:"widthLg",required:!1,type:{name:"string"}},confirmDialogTitle:{defaultValue:null,description:"",name:"confirmDialogTitle",required:!1,type:{name:"string"}},confirmDialogMessage:{defaultValue:null,description:"",name:"confirmDialogMessage",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/Drawer.tsx#Drawer"]={docgenInfo:Drawer.__docgenInfo,name:"Drawer",path:"src/components/ui/Drawer.tsx#Drawer"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/ui/Spin.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_icons_Loading__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/icons/Loading.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Spin=({spinning=!1,primary=!1,className,children})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("memori-spin",className,{"memori-spin--spinning":spinning,"memori-spin--primary":primary}),children:[children,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"memori-spin--spinner",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_icons_Loading__WEBPACK_IMPORTED_MODULE_2__.default,{loading:!0})})]});Spin.displayName="Spin";const __WEBPACK_DEFAULT_EXPORT__=Spin;try{Spin.displayName="Spin",Spin.__docgenInfo={description:"",displayName:"Spin",props:{spinning:{defaultValue:{value:"false"},description:"",name:"spinning",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},primary:{defaultValue:{value:"false"},description:"",name:"primary",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/Spin.tsx#Spin"]={docgenInfo:Spin.__docgenInfo,name:"Spin",path:"src/components/ui/Spin.tsx#Spin"})}catch(__react_docgen_typescript_loader_error){}},"./src/helpers/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{DN:()=>correctMaterials,GZ:()=>isSkinnedMesh,K1:()=>hasTouchscreen,KW:()=>usernameRegEx,Lr:()=>mailRegEx,N8:()=>safeParseJSON,TG:()=>cleanUrl,Vx:()=>stripDuplicates,Zn:()=>escapeHTML,_e:()=>stripHTML,eA:()=>stripMarkdown,f9:()=>stripOutputTags,gI:()=>stripReasoningTags,lA:()=>installMathJax,o6:()=>stripEmojis,pF:()=>pwdRegEx,xD:()=>useDebounceFn});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),three__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/three/build/three.module.js");const hasTouchscreen=()=>{let hasTouchScreen=!1;if("undefined"==typeof window||"undefined"==typeof navigator)return hasTouchScreen;if("maxTouchPoints"in navigator)hasTouchScreen=navigator.maxTouchPoints>0;else if("msMaxTouchPoints"in navigator)hasTouchScreen=navigator.msMaxTouchPoints>0;else{const mQ=window&&"matchMedia"in window&&matchMedia("(pointer:coarse)");if(mQ&&"(pointer:coarse)"===mQ.media)hasTouchScreen=!!mQ.matches;else if("orientation"in window)hasTouchScreen=!0;else{var UA=navigator?.userAgent;hasTouchScreen=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(UA)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(UA)}}return hasTouchScreen},pwdRegEx=/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$_:;|,~+=\{\}\[\]%^&*-]).{8,}$/,mailRegEx=/^\w+([.-]?[+]?\w+)*@\w+([.-]?\w+)*(\.\w{2,})+$/,usernameRegEx=/^(?!.*\.\.)(?!.*\.$)[^\W][\w.+-]{2,32}$/;function useDebounceFn(fn,delay){const timeoutId=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),originalFn=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>(originalFn.current=fn,()=>{originalFn.current=null}),[fn]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>()=>{clearTimeout(timeoutId.current)},[]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>(...args)=>{clearTimeout(timeoutId.current),timeoutId.current=window.setTimeout(()=>{originalFn.current&&originalFn.current(...args)},delay)},[delay])}const stripDuplicates=text=>text.slice(0,text.length/2).trim().toLowerCase()===text.slice(text.length/2+1).trim().toLowerCase()?text.slice(0,text.length/2):text,stripEmojis=text=>text.replaceAll(/[^\p{L}\p{N}\p{P}\p{Z}^$\n]/gu,"").trim(),stripMarkdown=text=>text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=(text=text.replaceAll(/```*?```/g,"")).replaceAll(/```[\s\S]*?```/g,"")).replaceAll(/`[^`]*`/g,"")).replaceAll(/!\[[^\]]*\]\([^)]*\)/g,"")).replaceAll(/\[([^\]]*)\]\([^)]*\)/g,"$1")).replaceAll(/^> /gm,"")).replaceAll(/^#+ /gm,"")).replaceAll(/[*_]/g,"")).replaceAll(/---/g,"")).replaceAll(/~~/g,"")).replaceAll(/^\s*[-*+] /gm,"")).replaceAll(/^\s*\d+\.\s+/gm,"")).replaceAll(/^\|.*\|$/gm,"")).replaceAll(/\$\$[\s\S]*?\$\$/g,"")).replaceAll(/\$[\s\S]*?\$/g,"")).replaceAll(/\\\([\s\S]*?\\\)/g,"")).replaceAll(/\\\[[\s\S]*?\\\]/g,"")).replaceAll(/\s+/g," ").trim(),stripOutputTags=text=>{const outputTagRegex=/<output.*?<\/output>/gs;if(!outputTagRegex.test(text))return text;const strippedText=text.replace(outputTagRegex,"");return stripOutputTags(strippedText)},stripReasoningTags=text=>{const reasoningTagRegex=/<think.*?<\/think>/gs;if(!reasoningTagRegex.test(text))return text;const strippedText=text.replace(reasoningTagRegex,"");return stripOutputTags(strippedText)},stripHTML=text=>{const el=document.createElement("div");return el.innerHTML=text,el.textContent||""},escapeHTML=text=>{const el=document.createElement("textarea");return el.textContent=text,el.innerHTML};function cleanUrl(href){try{href=encodeURI(href).replace(/%25/g,"%")}catch(e){return null}return href}const mathJaxConfig={startup:{elements:[".memori-chat--bubble-content"]},options:{processHtmlClass:"memori-chat--bubble-content"},tex:{inlineMath:[["$","$"],["\\$","\\$"]],displayMath:[["$$","$$"]],processEscapes:!0},asciimath:{fixphi:!0,displaystyle:!0,decimalsign:"."},skipStartupTypeset:!0,chtml:{displayAlign:"left"},svg:{fontCache:"global"}},installMathJax=()=>{window.MathJax=mathJaxConfig,(()=>{const script=document.createElement("script");script.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js",script.async=!0,script.id="mathjax-script",document.head.appendChild(script)})()};function correctMaterials(materials){Object.values(materials).forEach(material=>{material instanceof three__WEBPACK_IMPORTED_MODULE_1__.MeshStandardMaterial&&(material.roughness=.8,material.metalness=.1,material.shadowSide=2,material.map&&(material.map.anisotropy=16))})}function isSkinnedMesh(object){return!0===object.isSkinnedMesh}const safeParseJSON=(jsonString,fallbackString=!1)=>{try{return JSON.parse(jsonString)}catch(error){return fallbackString?jsonString:null}}}}]);